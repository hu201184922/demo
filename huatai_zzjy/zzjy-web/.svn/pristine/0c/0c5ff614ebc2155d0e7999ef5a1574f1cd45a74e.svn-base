<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huatai.web.mapper.UserSetWarnMapper">
	<resultMap id="BaseResultMap" type="com.huatai.web.model.UserSetWarn">
		<id column="BS_ID" jdbcType="INTEGER" property="bsId" />
		<result column="TARGET_CODE" jdbcType="VARCHAR" property="targetCode" />
		<result column="WARN_SETTING_TYPE" jdbcType="CHAR" property="warnSettingType" />
		<result column="USERNAME" jdbcType="VARCHAR" property="username" />
		<result column="ROLE_CODE" jdbcType="VARCHAR" property="roleCode" />
		<result column="WARN_CODE" jdbcType="VARCHAR" property="warnCode" />
		<result column="MIN_VAL" jdbcType="REAL" property="minVal" />
		<result column="MAX_VAL" jdbcType="REAL" property="maxVal" />
		<result column="ALERT_TYPE" jdbcType="CHAR" property="alertType" />
		<result column="ORG_TYPE" jdbcType="CHAR" property="orgType" />
		<result column="ORG_CODE" jdbcType="VARCHAR" property="orgCode" />
		<result column="ORG_NAME" jdbcType="VARCHAR" property="orgName" />
		<result column="WARN_STATUS" jdbcType="CHAR" property="warnStatus" />
		<result column="OP_TYPE" jdbcType="CHAR" property="opType" />
		<result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
		<result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
		<result column="CREATOR_ID" jdbcType="VARCHAR" property="creatorId" />
		<result column="MODIFIER_ID" jdbcType="VARCHAR" property="modifierId" />
	</resultMap>
	<sql id="Example_Where_Clause">
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		BS_ID, TARGET_CODE, WARN_SETTING_TYPE, USERNAME, ROLE_CODE, WARN_CODE,
		MIN_VAL, MAX_VAL,
		ALERT_TYPE, ORG_TYPE, ORG_CODE, ORG_NAME, WARN_STATUS, OP_TYPE, CREATE_TIME,
		MODIFY_TIME,
		CREATOR_ID, MODIFIER_ID
	</sql>
	<select id="selectByExample" parameterType="com.huatai.web.model.UserSetWarnExample"
		resultMap="BaseResultMap">
		select
		<if test="distinct">
			distinct
		</if>
		'true' as QUERYID,
		<include refid="Base_Column_List" />
		from ht_user_set_warn_tb
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
	<select id="selectByPrimaryKey" parameterType="java.lang.Integer"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from ht_user_set_warn_tb
		where BS_ID = #{bsId,jdbcType=INTEGER}
		and OP_TYPE != 'D'
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- delete from ht_user_set_warn_tb -->
		<!-- where BS_ID = #{bsId,jdbcType=INTEGER} -->
		update ht_user_set_warn_tb set op_type = 'D' where BS_ID =
		#{bsId,jdbcType=INTEGER}
	</delete>
	<delete id="deleteByExample" parameterType="com.huatai.web.model.UserSetWarnExample">
		delete from ht_user_set_warn_tb
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.huatai.web.model.UserSetWarn">
		insert into ht_user_set_warn_tb (BS_ID, TARGET_CODE, WARN_SETTING_TYPE,
		USERNAME, ROLE_CODE, WARN_CODE,
		MIN_VAL, MAX_VAL, ALERT_TYPE, ORG_TYPE,
		ORG_CODE, ORG_NAME, WARN_STATUS,
		OP_TYPE, CREATE_TIME, MODIFY_TIME,
		CREATOR_ID, MODIFIER_ID)
		values (#{bsId,jdbcType=INTEGER}, #{targetCode,jdbcType=VARCHAR},
		#{warnSettingType,jdbcType=CHAR},
		#{username,jdbcType=VARCHAR}, #{roleCode,jdbcType=VARCHAR}, #{warnCode,jdbcType=VARCHAR},
		#{minVal,jdbcType=REAL}, #{maxVal,jdbcType=REAL},
		#{alertType,jdbcType=CHAR}, #{orgType,jdbcType=CHAR},
		#{orgCode,jdbcType=VARCHAR}, #{orgName,jdbcType=VARCHAR},
		#{warnStatus,jdbcType=CHAR},
		#{opType,jdbcType=CHAR}, #{createTime,jdbcType=TIMESTAMP}, #{modifyTime,jdbcType=TIMESTAMP},
		#{creatorId,jdbcType=VARCHAR}, #{modifierId,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.huatai.web.model.UserSetWarn">
		insert into ht_user_set_warn_tb
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="bsId != null">
				BS_ID,
			</if>
			<if test="targetCode != null">
				TARGET_CODE,
			</if>
			<if test="warnSettingType != null">
				WARN_SETTING_TYPE,
			</if>
			<if test="username != null">
				USERNAME,
			</if>
			<if test="roleCode != null">
				ROLE_CODE,
			</if>
			<if test="warnCode != null">
				WARN_CODE,
			</if>
			<if test="minVal != null">
				MIN_VAL,
			</if>
			<if test="maxVal != null">
				MAX_VAL,
			</if>
			<if test="alertType != null">
				ALERT_TYPE,
			</if>
			<if test="orgType != null">
				ORG_TYPE,
			</if>
			<if test="orgCode != null">
				ORG_CODE,
			</if>
			<if test="orgName != null">
				ORG_NAME,
			</if>
			<if test="warnStatus != null">
				WARN_STATUS,
			</if>
			<if test="opType != null">
				OP_TYPE,
			</if>
			<if test="createTime != null">
				CREATE_TIME,
			</if>
			<if test="modifyTime != null">
				MODIFY_TIME,
			</if>
			<if test="creatorId != null">
				CREATOR_ID,
			</if>
			<if test="modifierId != null">
				MODIFIER_ID,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="bsId != null">
				#{bsId,jdbcType=INTEGER},
			</if>
			<if test="targetCode != null">
				#{targetCode,jdbcType=VARCHAR},
			</if>
			<if test="warnSettingType != null">
				#{warnSettingType,jdbcType=CHAR},
			</if>
			<if test="username != null">
				#{username,jdbcType=VARCHAR},
			</if>
			<if test="roleCode != null">
				#{roleCode,jdbcType=VARCHAR},
			</if>
			<if test="warnCode != null">
				#{warnCode,jdbcType=VARCHAR},
			</if>
			<if test="minVal != null">
				#{minVal,jdbcType=REAL},
			</if>
			<if test="maxVal != null">
				#{maxVal,jdbcType=REAL},
			</if>
			<if test="alertType != null">
				#{alertType,jdbcType=CHAR},
			</if>
			<if test="orgType != null">
				#{orgType,jdbcType=CHAR},
			</if>
			<if test="orgCode != null">
				#{orgCode,jdbcType=VARCHAR},
			</if>
			<if test="orgName != null">
				#{orgName,jdbcType=VARCHAR},
			</if>
			<if test="warnStatus != null">
				#{warnStatus,jdbcType=CHAR},
			</if>
			<if test="opType != null">
				#{opType,jdbcType=CHAR},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				#{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="creatorId != null">
				#{creatorId,jdbcType=VARCHAR},
			</if>
			<if test="modifierId != null">
				#{modifierId,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.huatai.web.model.UserSetWarnExample"
		resultType="java.lang.Integer">
		select count(*) from ht_user_set_warn_tb
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		update ht_user_set_warn_tb
		<set>
			<if test="record.bsId != null">
				BS_ID = #{record.bsId,jdbcType=INTEGER},
			</if>
			<if test="record.targetCode != null">
				TARGET_CODE = #{record.targetCode,jdbcType=VARCHAR},
			</if>
			<if test="record.warnSettingType != null">
				WARN_SETTING_TYPE = #{record.warnSettingType,jdbcType=CHAR},
			</if>
			<if test="record.username != null">
				USERNAME = #{record.username,jdbcType=VARCHAR},
			</if>
			<if test="record.roleCode != null">
				ROLE_CODE = #{record.roleCode,jdbcType=VARCHAR},
			</if>
			<if test="record.warnCode != null">
				WARN_CODE = #{record.warnCode,jdbcType=VARCHAR},
			</if>
			<if test="record.minVal != null">
				MIN_VAL = #{record.minVal,jdbcType=REAL},
			</if>
			<if test="record.maxVal != null">
				MAX_VAL = #{record.maxVal,jdbcType=REAL},
			</if>
			<if test="record.alertType != null">
				ALERT_TYPE = #{record.alertType,jdbcType=CHAR},
			</if>
			<if test="record.orgType != null">
				ORG_TYPE = #{record.orgType,jdbcType=CHAR},
			</if>
			<if test="record.orgCode != null">
				ORG_CODE = #{record.orgCode,jdbcType=VARCHAR},
			</if>
			<if test="record.orgName != null">
				ORG_NAME = #{record.orgName,jdbcType=VARCHAR},
			</if>
			<if test="record.warnStatus != null">
				WARN_STATUS = #{record.warnStatus,jdbcType=CHAR},
			</if>
			<if test="record.opType != null">
				OP_TYPE = #{record.opType,jdbcType=CHAR},
			</if>
			<if test="record.createTime != null">
				CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="record.modifyTime != null">
				MODIFY_TIME = #{record.modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="record.creatorId != null">
				CREATOR_ID = #{record.creatorId,jdbcType=VARCHAR},
			</if>
			<if test="record.modifierId != null">
				MODIFIER_ID = #{record.modifierId,jdbcType=VARCHAR},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		update ht_user_set_warn_tb
		set BS_ID = #{record.bsId,jdbcType=INTEGER},
		TARGET_CODE = #{record.targetCode,jdbcType=VARCHAR},
		WARN_SETTING_TYPE = #{record.warnSettingType,jdbcType=CHAR},
		USERNAME = #{record.username,jdbcType=VARCHAR},
		ROLE_CODE = #{record.roleCode,jdbcType=VARCHAR},
		WARN_CODE = #{record.warnCode,jdbcType=VARCHAR},
		MIN_VAL = #{record.minVal,jdbcType=REAL},
		MAX_VAL = #{record.maxVal,jdbcType=REAL},
		ALERT_TYPE = #{record.alertType,jdbcType=CHAR},
		ORG_TYPE = #{record.orgType,jdbcType=CHAR},
		ORG_CODE = #{record.orgCode,jdbcType=VARCHAR},
		ORG_NAME = #{record.orgName,jdbcType=VARCHAR},
		WARN_STATUS = #{record.warnStatus,jdbcType=CHAR},
		OP_TYPE = #{record.opType,jdbcType=CHAR},
		CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
		MODIFY_TIME = #{record.modifyTime,jdbcType=TIMESTAMP},
		CREATOR_ID = #{record.creatorId,jdbcType=VARCHAR},
		MODIFIER_ID = #{record.modifierId,jdbcType=VARCHAR}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.huatai.web.model.UserSetWarn">
		update ht_user_set_warn_tb
		<set>
			<if test="targetCode != null">
				TARGET_CODE = #{targetCode,jdbcType=VARCHAR},
			</if>
			<if test="warnSettingType != null">
				WARN_SETTING_TYPE = #{warnSettingType,jdbcType=CHAR},
			</if>
			<if test="username != null">
				USERNAME = #{username,jdbcType=VARCHAR},
			</if>
			<if test="roleCode != null">
				ROLE_CODE = #{roleCode,jdbcType=VARCHAR},
			</if>
			<if test="warnCode != null">
				WARN_CODE = #{warnCode,jdbcType=VARCHAR},
			</if>
			<if test="minVal != null">
				MIN_VAL = #{minVal,jdbcType=REAL},
			</if>
			<if test="maxVal != null">
				MAX_VAL = #{maxVal,jdbcType=REAL},
			</if>
			<if test="alertType != null">
				ALERT_TYPE = #{alertType,jdbcType=CHAR},
			</if>
			<if test="orgType != null">
				ORG_TYPE = #{orgType,jdbcType=CHAR},
			</if>
			<if test="orgCode != null">
				ORG_CODE = #{orgCode,jdbcType=VARCHAR},
			</if>
			<if test="orgName != null">
				ORG_NAME = #{orgName,jdbcType=VARCHAR},
			</if>
			<if test="warnStatus != null">
				WARN_STATUS = #{warnStatus,jdbcType=CHAR},
			</if>
			<if test="opType != null">
				OP_TYPE = #{opType,jdbcType=CHAR},
			</if>
			<if test="createTime != null">
				CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="creatorId != null">
				CREATOR_ID = #{creatorId,jdbcType=VARCHAR},
			</if>
			<if test="modifierId != null">
				MODIFIER_ID = #{modifierId,jdbcType=VARCHAR},
			</if>
		</set>
		where BS_ID = #{bsId,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.huatai.web.model.UserSetWarn">
		update ht_user_set_warn_tb
		set TARGET_CODE = #{targetCode,jdbcType=VARCHAR},
		WARN_SETTING_TYPE = #{warnSettingType,jdbcType=CHAR},
		USERNAME = #{username,jdbcType=VARCHAR},
		ROLE_CODE = #{roleCode,jdbcType=VARCHAR},
		WARN_CODE = #{warnCode,jdbcType=VARCHAR},
		MIN_VAL = #{minVal,jdbcType=REAL},
		MAX_VAL = #{maxVal,jdbcType=REAL},
		ALERT_TYPE = #{alertType,jdbcType=CHAR},
		ORG_TYPE = #{orgType,jdbcType=CHAR},
		ORG_CODE = #{orgCode,jdbcType=VARCHAR},
		ORG_NAME = #{orgName,jdbcType=VARCHAR},
		WARN_STATUS = #{warnStatus,jdbcType=CHAR},
		OP_TYPE = #{opType,jdbcType=CHAR},
		CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
		MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
		CREATOR_ID = #{creatorId,jdbcType=VARCHAR},
		MODIFIER_ID = #{modifierId,jdbcType=VARCHAR}
		where BS_ID = #{bsId,jdbcType=INTEGER}
	</update>
	<!-- 分页查询 -->
	<select id="findByPager" resultMap="BaseResultMap"
		parameterType="com.huatai.web.model.UserSetWarn">
		select
		T.TARGET_NAME targetName,W.*
		FROM
		ht_user_set_warn_tb w LEFT JOIN
		ht_target_tb t
		on
		w.TARGET_CODE = t.TARGET_CODE
		<where>
			<if test="orgName != null and orgName != ''">
				and W.ORG_NAME like '%${orgName}%'
			</if>
			<if test="warnTarget != null and warnTarget != ''">
				and T.TARGET_NAME like '%${warnTarget}%'
			</if>
			<if test="warnStatus != null and warnStatus != ''">
				and W.WARN_STATUS = #{warnStatus}
			</if>
			and w.CREATOR_ID = #{userName}
			and w.OP_TYPE != "D"
			and t.OP_TYPE != "D"
		</where>
		ORDER BY w.CREATE_TIME DESC
	</select>


	<!-- 分页查询预警结果 -->
	<select id="findResultByPager" resultMap="BaseResultMap"
		parameterType="com.huatai.web.model.UserSetWarn">
		SELECT
		*
		FROM
		(
		SELECT
		t.TARGET_NAME targetName,
		r.WARN_VAL warnVal,
		r.WARN_TIME warnTime,
		W.*
		FROM
		ht_warn_result_tb r,
		ht_user_set_warn_tb w,
		ht_target_tb t
		WHERE
		w.BS_ID = r.BS_ID
		AND w.TARGET_CODE = t.TARGET_CODE
		AND w.OP_TYPE != 'D'
		AND t.OP_TYPE != 'D'
		ORDER BY
		r.WARN_TIME DESC
		) tem
		GROUP BY
		tem.BS_ID
		<where>
			<if test="RorgName != null and RorgName !=''">
				and W.ORG_NAME like '%${RorgName}%'
			</if>
			<if test="RwarnTarget != null and RwarnTarget !=''">
				and T.TARGET_NAME like '%${RwarnTarget}%'
			</if>
		</where>
	</select>
	<!-- 查询用户预警 -->
	<select id="findUserSetWarnByPage" resultMap="BaseResultMap"
		parameterType="com.huatai.web.model.UserSetWarn">
		select
		<include refid="Base_Column_List" />
		from ht_user_set_warn_tb
		WHERE OP_TYPE != 'D' AND ((
		<if test="username != null and username !=''">
			USERNAME = #{username,jdbcType=VARCHAR}
		</if>
		<if test="targetCode != null and targetCode !=''">
			and TARGET_CODE = #{targetCode,jdbcType=VARCHAR}
		</if>
		<if test="roleCode != null and roleCode !=''">
			and ROLE_CODE = #{roleCode,jdbcType=VARCHAR}
		</if>
		AND WARN_SETTING_TYPE = 1
		) OR
		( WARN_SETTING_TYPE = 2
		<if test="orgCode != null and orgCode !='' ">
			and ORG_CODE = #{orgCode,jdbcType=VARCHAR}
		</if>
		))
		<if test="targetName != null and targetName !=''">
			and TARGET_NAME LIKE CONCAT(CONCAT('%',#{targetName}),'%')
		</if>
		<if test="warnStatus != null and warnStatus !=''">
			and WARN_STATUS = #{warnStatus,jdbcType=CHAR}
		</if>
		order by WARN_STATUS desc,MODIFY_TIME desc
	</select>
	<!-- 修改预警状态 -->
	<update id="updateStatus" parameterType="String">
		UPDATE
		ht_user_set_warn_tb SET WARN_STATUS = #{status} WHERE BS_ID = #{bsid}
	</update>


	<!-- 根据id获取预警信息 -->
	<select id="findWarnById" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		SELECT
		t.TARGET_NAME targetName,
		t.FIELD_CODE,
		w.*
		FROM
		ht_user_set_warn_tb w,
		ht_target_tb t
		WHERE
		t.TARGET_CODE = w.TARGET_CODE
		AND BS_ID = #{bsId,jdbcType=INTEGER}
	</select>


	<!-- 保存更新 -->
	<update id="updateWarn" parameterType="com.huatai.web.model.UserSetWarn">
		update ht_user_set_warn_tb
		<set>
			<if test="targetCode != null">
				TARGET_CODE = #{targetCode,jdbcType=VARCHAR},
			</if>
			<if test="username != null">
				USERNAME = #{userName,jdbcType=VARCHAR},
			</if>
			<if test="roleCode != null">
				ROLE_CODE = #{roleCode,jdbcType=VARCHAR},
			</if>
			MIN_VAL = #{minVal,jdbcType=REAL},
			MAX_VAL = #{maxVal,jdbcType=REAL},
			<if test="warnCode != null">
				WARN_CODE = #{warnCode,jdbcType=VARCHAR},
			</if>
			<if test="alertType != null">
				ALERT_TYPE = #{alertType,jdbcType=CHAR},
			</if>
			<if test="orgType != null">
				ORG_TYPE = #{orgType,jdbcType=CHAR},
			</if>
			<if test="orgCode != null">
				ORG_CODE = #{orgCode,jdbcType=VARCHAR},
			</if>
			<if test="orgName != null">
				ORG_NAME = #{orgName,jdbcType=VARCHAR},
			</if>
			<if test="warnStatus != null">
				WARN_STATUS = #{warnStatus,jdbcType=CHAR},
			</if>
			<if test="opType != null">
				OP_TYPE = #{opType,jdbcType=CHAR},
			</if>
			<if test="createTime != null">
				CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="creatorId != null">
				CREATOR_ID = #{creatorId,jdbcType=VARCHAR},
			</if>
			<if test="modifierId != null">
				MODIFIER_ID = #{modifierId,jdbcType=VARCHAR},
			</if>
		</set>
		where BS_ID = #{bsId,jdbcType=INTEGER}
	</update>
	<select id="findNoResOnWarn" parameterType="java.lang.String"
		resultMap="BaseResultMap">
		select a.* from ht_user_set_warn_tb a
		where a.warn_status = 1 and a.op_type
		!= 'D'
		and ((a.WARN_SETTING_TYPE = 1 and a.role_code = '${role}') or
		(a.WARN_SETTING_TYPE = 2 and a.ORG_CODE = '${roleOrg}'))
		AND NOT EXISTS(SELECT 1
		FROM ht_warn_result_tb b
		WHERE b.is_read = 1 AND a.bs_id = b.bs_id)
	</select>

	<!-- 查询用户预警扩展模糊查询 -->
	<select id="findUserSetWarnByNamePage" resultMap="BaseResultMap"
		parameterType="com.huatai.web.model.UserSetWarn">
		select u.*
		from ht_user_set_warn_tb u LEFT JOIN ht_target_tb t ON
		u.TARGET_CODE=t.TARGET_CODE
		WHERE u.OP_TYPE != 'D' and t.OP_TYPE != 'D'
		and ((
		<if test="username != null and username !=''">
			USERNAME = #{username,jdbcType=VARCHAR}
		</if>
		<if test="targetCode != null and targetCode !=''">
			and TARGET_CODE = #{targetCode,jdbcType=VARCHAR}
		</if>
		<if test="roleCode != null and roleCode !=''">
			and ROLE_CODE = #{roleCode,jdbcType=VARCHAR}
		</if>

		AND WARN_SETTING_TYPE = 1
		) OR
		( WARN_SETTING_TYPE = 2
		<if test="orgCode != null and orgCode !='' ">
			and ORG_CODE = #{orgCode,jdbcType=VARCHAR}
		</if>
		))
		<if test="warnStatus != null and warnStatus !=''">
			and WARN_STATUS = #{warnStatus,jdbcType=CHAR}
		</if>
		<if test="targetName != null and targetName !=''">
			and TARGET_NAME LIKE CONCAT(CONCAT('%',#{targetName}),'%')
		</if>
		order by WARN_STATUS desc,MODIFY_TIME desc
	</select>

	<!-- 查询预警方式 -->
	<select id="findAlertType" resultType="String">
		SELECT
		NAME_ name
		FROM
		jdp_dict_item
		WHERE
		DICT_ID = (
		SELECT
		CID
		FROM
		jdp_dict
		WHERE
		CODE_ = 'ALERT_TYPE'
		)
	</select>
	<select id="selectByPrimaryKeyAndNoOp" parameterType="java.lang.Integer"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from ht_user_set_warn_tb
		where BS_ID = #{bsId,jdbcType=INTEGER}
	</select>
</mapper>