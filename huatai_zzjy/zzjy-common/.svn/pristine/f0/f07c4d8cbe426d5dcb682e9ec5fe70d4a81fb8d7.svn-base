<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ehuatai.biz.mapper.SQLMapper">

	<select id="findBySQL" parameterType="String" resultType="java.util.HashMap">
		${sql}
	</select>

	<select id="findPagerBySQL" parameterType="String" resultType="java.util.HashMap">
		select * from (
		${sql}
		)
		<where>
			1=1
		</where>
	</select>

	<select id="searchOrg01" resultType="java.util.HashMap">
		WITH T1 AS
		(SELECT DISTINCT
		T.PROVCOMCODE AS O_CODE, T.TEAMCOMSHORTNAME
		AS O_NAME
		FROM D_MANAGECOM
		T
		WHERE T.PROVCOMCODE != '1')
		,
		T2 AS
		(SELECT
		T.COUNTCOMCODE AS O_CODE,
		T.ACTUTEAMCOMSHORTNAME AS O_NAME
		FROM
		D_MANAGECOM T
		WHERE
		LENGTH(T.COUNTCOMCODE) = 5)
		<if test="type=='0'">
			,
			T3 AS
			(SELECT DISTINCT T.TEAMCOMCODE AS
			O_CODE,
			T.TEAMCOMNAME AS O_NAME
			FROM D_ORGANIZATION T
			WHERE TEAMCOMCODE
			IS NOT
			NULL
			AND TEAMCOMNAME IS NOT NULL),
			T4 AS
			(SELECT DISTINCT
			T.COST_CENTERSTDCODE AS O_CODE,
			T.COST_CENTERDEVNAME AS O_NAME
			FROM
			D_ORGANIZATION T
			WHERE COST_CENTERSTDCODE IS NOT NULL
			AND
			COST_CENTERDEVNAME IS NOT NULL)
		</if>
		SELECT '7' AS O_TYPE, T1.O_CODE AS
		O_CODE, T1.O_NAME AS O_NAME
		FROM T1
		WHERE T1.O_CODE LIKE '%${code}%'
		OR
		T1.O_NAME LIKE '%${code}%'
		UNION
		SELECT '6' AS O_TYPE, T2.O_CODE AS
		O_CODE,
		T2.O_NAME AS O_NAME
		FROM T2
		WHERE T2.O_CODE LIKE '%${code}%'
		OR
		T2.O_NAME LIKE
		'%${code}%'
		<if test="type=='0'">
			UNION
			SELECT '501' AS O_TYPE, T3.O_CODE AS
			O_CODE
			,
			T3.O_NAME
			AS
			O_NAME
			FROM T3
			WHERE T3.O_CODE LIKE '%${code}%'
			OR
			T3.O_NAME
			LIKE
			'%${code}%'
			UNION
			SELECT '502' AS O_TYPE, T4.O_CODE AS
			O_CODE,
			T4.O_NAME
			AS O_NAME
			FROM
			T4
			WHERE T4.O_CODE LIKE '%${code}%'
			OR
			T4.O_NAME
			LIKE
			'%${code}%'
		</if>
	</select>

	<select id="searchOrg02" resultType="java.util.HashMap">
		WITH T2 AS
		(SELECT
		T.COUNTCOMCODE AS O_CODE,
		T.ACTUTEAMCOMSHORTNAME AS
		O_NAME
		FROM
		D_MANAGECOM T
		WHERE
		LENGTH(T.COUNTCOMCODE) = 5)
		<if test="type=='0'">
			,
			T3 AS
			(SELECT
			DISTINCT
			T.TEAMCOMCODE AS
			O_CODE, T.TEAMCOMNAME
			AS O_NAME
			FROM
			D_ORGANIZATION T
			WHERE TEAMCOMCODE
			IS NOT NULL
			AND
			TEAMCOMNAME IS NOT
			NULL),
			T4 AS
			(SELECT
			DISTINCT
			T.COST_CENTERSTDCODE AS
			O_CODE,
			T.COST_CENTERDEVNAME AS O_NAME
			FROM
			D_ORGANIZATION T
			WHERE
			COST_CENTERSTDCODE IS NOT NULL
			AND
			COST_CENTERDEVNAME IS NOT NULL)
		</if>
		SELECT '6' AS O_TYPE, T2.O_CODE AS
		O_CODE,
		T2.O_NAME AS O_NAME
		FROM T2
		WHERE T2.O_CODE LIKE '%${code}%'
		OR
		T2.O_NAME LIKE
		'%${code}%'
		<if test="type=='0'">
			UNION
			SELECT '501' AS O_TYPE, T3.O_CODE AS
			O_CODE
			,
			T3.O_NAME AS
			O_NAME
			FROM T3
			WHERE T3.O_CODE LIKE '%${code}%'
			OR
			T3.O_NAME
			LIKE '%${code}%'
			UNION
			SELECT '502' AS O_TYPE, T4.O_CODE AS
			O_CODE,
			T4.O_NAME AS O_NAME
			FROM
			T4
			WHERE T4.O_CODE LIKE '%${code}%'
			OR
			T4.O_NAME
			LIKE '%${code}%'
		</if>
	</select>

	<select id="searchOrg03" resultType="java.util.HashMap">
		WITH T3 AS
		(SELECT
		DISTINCT
		T.TEAMCOMCODE AS
		O_CODE, T.TEAMCOMNAME AS O_NAME
		FROM
		D_ORGANIZATION T
		WHERE TEAMCOMCODE
		IS NOT NULL
		AND TEAMCOMNAME IS NOT
		NULL),
		T4 AS
		(SELECT
		DISTINCT
		T.COST_CENTERSTDCODE AS O_CODE,
		T.COST_CENTERDEVNAME AS O_NAME
		FROM
		D_ORGANIZATION T
		WHERE
		COST_CENTERSTDCODE IS NOT NULL
		AND
		COST_CENTERDEVNAME IS NOT NULL)
		SELECT '501' AS O_TYPE, T3.O_CODE AS
		O_CODE,
		T3.O_NAME AS
		O_NAME
		FROM T3
		WHERE T3.O_CODE LIKE '%${code}%'
		OR
		T3.O_NAME
		LIKE '%${code}%'
		UNION
		SELECT '502' AS O_TYPE, T4.O_CODE AS
		O_CODE,
		T4.O_NAME AS O_NAME
		FROM
		T4
		WHERE T4.O_CODE LIKE '%${code}%'
		OR
		T4.O_NAME
		LIKE '%${code}%'
	</select>

	<select id="getBranchByCompany" resultType="java.util.HashMap">
		SELECT COUNTCOMCODE AS CODE, ACTUTEAMCOMSHORTNAME AS
		NAME FROM
		D_MANAGECOM
		WHERE
		PROVCOMCODE = #{code}
		<if test="code=='101'">
			AND 1 = 1
		</if>
		<if test="code!='101'">
			AND COUNTCOMCODE !=
			#{code}
		</if>
		ORDER BY
		CODE
	</select>


</mapper>