<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ehuatai.biz.mapper.GdzbMapper">
	<select id="R1301070001" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		PROVCODE,TEAMCOMSHORTNAME AS PROVNAME
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.IN_MANPOW),0) AS VAL1
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE =
		TO_CHAR(TO_DATE(SUBSTR(#{end_time},1,4),'YYYY')-1,'YYYY-MM-DD')
		GROUP
		BY D.PROVCOMCODE
		),
		T3 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.ADD_MANPOW),0) AS VAL1,
		NVL(SUM(A.DROP_MANPOW),0) AS VAL2,
		NVL(SUM(A.NET_GROWTH_MANPOW),0) AS VAL3
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT
		JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(LAST_DAY(TO_DATE(A.DATE_CODE,'YYYY-MM-DD')),'YYYY-MM-DD') )
		GROUP BY D.PROVCOMCODE
		),
		T4 AS(
		SELECT D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.IN_MANPOW),0) AS VAL1
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;= SUBSTR(#{end_time},1,7)||'-01'
		AND A.DATE_CODE &lt;=
		SUBSTR(#{end_time},1,7)||'-31'
		GROUP BY D.PROVCOMCODE
		),
		T5 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.IN_MANPOW),0) AS VAL1
		FROM
		HT_ORG_DEVE_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE &gt;=
		TO_CHAR(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'YYYY-MM')||'-01'
		AND A.DATE_CODE &lt;=
		TO_CHAR(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'YYYY-MM')||'-31'
		GROUP BY D.PROVCOMCODE
		),
		T6 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.ADD_MANPOW),0) AS VAL1,
		NVL(SUM(A.NET_GROWTH_NUM),0) AS VAL2
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN D_MANAGECOM D ON A.ORG_CODE =
		D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE = SUBSTR(#{end_time},1,4)
		GROUP
		BY D.PROVCOMCODE
		),
		T7 AS (
		SELECT
		T1.PROVNAME AS VAL0,
		TRIM(TO_CHAR(TRUNC(NVL(T2.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(T3.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(T3.VAL2,0)/100,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(T3.VAL3,0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(TRUNC(NVL(T4.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(T5.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL6,
		DECODE(NVL(T5.VAL1,0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(T4.VAL1,0)/T5.VAL1-1)*100,2),'999999999999999999990.99')))
		AS VAL7,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL8,
		DECODE(NVL(T6.VAL1,0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(T3.VAL1,0)/T6.VAL1-1)*100,2),'999999999999999999990.99')))
		AS VAL9,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL2,0)/100,2),'999999999999999999990.99'))
		AS VAL10,
		DECODE(NVL(T6.VAL2,0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(T3.VAL3,0)/T6.VAL2-1)*100,2),'999999999999999999990.99')))
		AS VAL11
		FROM T1
		LEFT JOIN T2 ON T1.PROVCODE = T2.VAL0
		LEFT JOIN T3 ON
		T1.PROVCODE = T3.VAL0
		LEFT JOIN T4 ON T1.PROVCODE = T4.VAL0
		LEFT JOIN T5
		ON T1.PROVCODE = T5.VAL0
		LEFT JOIN T6 ON T1.PROVCODE = T6.VAL0
		ORDER BY
		T1.PROVCODE
		)

		SELECT * FROM T7
		UNION ALL
		SELECT
		'全系统' AS VALO,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL2),0)/100,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL3),0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL6,
		DECODE(NVL(SUM(T5.VAL1),0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(SUM(T4.VAL1),0)/SUM(T5.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL7,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T6.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL8,
		DECODE(NVL(SUM(T6.VAL1),0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(SUM(T3.VAL1),0)/SUM(T6.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL9,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T6.VAL2),0)/100,2),'999999999999999999990.99'))
		AS VAL10,
		DECODE(NVL(SUM(T6.VAL2),0),0,'--',TRIM(TO_CHAR(TRUNC((NVL(SUM(T3.VAL3),0)/SUM(T6.VAL2)-1)*100,2),'999999999999999999990.99')))
		AS VAL11
		FROM T1
		LEFT JOIN T2 ON T1.PROVCODE = T2.VAL0
		LEFT JOIN T3 ON
		T1.PROVCODE = T3.VAL0
		LEFT JOIN T4 ON T1.PROVCODE = T4.VAL0
		LEFT JOIN T5
		ON T1.PROVCODE = T5.VAL0
		LEFT JOIN T6 ON T1.PROVCODE = T6.VAL0

	</select>
	<select id="R1301070002" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		PROVCODE,TEAMCOMSHORTNAME AS PROVNAME
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		SUM(CASE
		WHEN A.GRADE_CODE IN ('03','04','133') THEN A.MONTH_MANAGE_ADD_MANPOW
		ELSE 0 END ) AS VAL1,
		SUM(CASE WHEN A.GRADE_CODE IN ('05') THEN
		A.MONTH_MANAGE_ADD_MANPOW ELSE 0 END
		) AS VAL2,
		SUM(CASE WHEN
		A.GRADE_CODE IN ('07','08') THEN A.MONTH_MANAGE_ADD_MANPOW ELSE
		0 END )
		AS VAL3,
		SUM(CASE WHEN A.GRADE_CODE IN ('03','04','133','05','07','08')
		THEN
		A.MONTH_MANAGE_ADD_MANPOW ELSE 0 END ) AS VAL4,
		SUM(CASE WHEN
		A.GRADE_CODE IN ('03','04','133') THEN A.PRE_GOLD_BEE ELSE 0 END
		) AS
		VAL11,
		SUM(CASE WHEN A.GRADE_CODE IN ('05') THEN A.PRE_GOLD_BEE ELSE 0
		END ) AS
		VAL12,
		SUM(CASE WHEN A.GRADE_CODE IN ('07','08') THEN
		A.PRE_GOLD_BEE ELSE 0 END ) AS
		VAL13,
		SUM(CASE WHEN A.GRADE_CODE IN
		('03','04','133','05','07','08') THEN
		A.PRE_GOLD_BEE ELSE 0 END ) AS
		VAL14,
		SUM(CASE WHEN A.GRADE_CODE IN ('03','04','133') THEN
		A.FINAL_MANAGE_IN_MANPOW
		ELSE 0 END ) AS VAL21,
		SUM(CASE WHEN
		A.GRADE_CODE IN ('05') THEN A.FINAL_MANAGE_IN_MANPOW ELSE 0 END
		) AS
		VAL22,
		SUM(CASE WHEN A.GRADE_CODE IN ('07','08') THEN
		A.FINAL_MANAGE_IN_MANPOW ELSE 0
		END ) AS VAL23,
		SUM(CASE WHEN
		A.GRADE_CODE IN ('03','04','133','05','07','08') THEN
		A.FINAL_MANAGE_IN_MANPOW ELSE 0 END ) AS VAL24
		FROM HT_ORG_DEVE_DAY_TB
		A
		LEFT JOIN D_MANAGECOM D ON
		A.MANAGECOM_CODE = D.MANAGECOMCODE
		LEFT JOIN
		D_GRADE G ON A.GRADE_CODE
		= G.GRADECODE
		WHERE 1=1
		AND A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(LAST_DAY(TO_DATE(A.DATE_CODE,'YYYY-MM-DD')),'YYYY-MM-DD') )
		GROUP BY D.PROVCOMCODE
		)
		,T3 AS (
		SELECT
		T1.PROVNAME AS VAL0,
		DECODE(NVL(T2.VAL21,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL1
		,0)/T2.VAL21*100,2),'999999999999999999990.99'))) AS VAL1,
		DECODE(NVL(T2.VAL21,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL11,0)/T2.VAL21*100,2),'999999999999999999990.99')))
		AS VAL2,
		DECODE(NVL(T2.VAL22,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL2
		,0)/T2.VAL22*100,2),'999999999999999999990.99'))) AS VAL3,
		DECODE(NVL(T2.VAL22,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL12,0)/T2.VAL22*100,2),'999999999999999999990.99')))
		AS VAL4,
		DECODE(NVL(T2.VAL23,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL3
		,0)/T2.VAL23*100,2),'999999999999999999990.99'))) AS VAL5,
		DECODE(NVL(T2.VAL23,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL13,0)/T2.VAL23*100,2),'999999999999999999990.99')))
		AS VAL6,
		DECODE(NVL(T2.VAL24,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL4
		,0)/T2.VAL24*100,2),'999999999999999999990.99'))) AS VAL7,
		DECODE(NVL(T2.VAL24,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T2.VAL14,0)/T2.VAL24*100,2),'999999999999999999990.99')))
		AS VAL8
		FROM T1 LEFT JOIN T2 ON T1.PROVCODE = T2.VAL0
		ORDER BY
		T1.PROVCODE ASC
		)
		SELECT * FROM T3
		UNION ALL
		SELECT
		'全系统' AS VALO,
		DECODE(NVL(SUM(T2.VAL21),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL1
		),0)/SUM(T2.VAL21)*100,2),'999999999999999999990.99'))) AS VAL1,
		DECODE(NVL(SUM(T2.VAL21),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL11),0)/SUM(T2.VAL21)*100,2),'999999999999999999990.99')))
		AS VAL2,
		DECODE(NVL(SUM(T2.VAL22),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL2
		),0)/SUM(T2.VAL22)*100,2),'999999999999999999990.99'))) AS VAL3,
		DECODE(NVL(SUM(T2.VAL22),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL12),0)/SUM(T2.VAL22)*100,2),'999999999999999999990.99')))
		AS VAL4,
		DECODE(NVL(SUM(T2.VAL23),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL3
		),0)/SUM(T2.VAL23)*100,2),'999999999999999999990.99'))) AS VAL5,
		DECODE(NVL(SUM(T2.VAL23),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL13),0)/SUM(T2.VAL23)*100,2),'999999999999999999990.99')))
		AS VAL6,
		DECODE(NVL(SUM(T2.VAL24),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL4
		),0)/SUM(T2.VAL24)*100,2),'999999999999999999990.99'))) AS VAL7,
		DECODE(NVL(SUM(T2.VAL24),0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL14),0)/SUM(T2.VAL24)*100,2),'999999999999999999990.99')))
		AS VAL8
		FROM T1 LEFT JOIN T2 ON T1.PROVCODE = T2.VAL0

	</select>
	<select id="R1301070003" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT 0 AS VAL0 WHERE DUAL WHERE 1=0
	</select>
	<select id="R1301070004" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT 0 AS VAL0 WHERE DUAL WHERE 1=0
	</select>
	<select id="R1301070005" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		PROVCODE,TEAMCOMSHORTNAME AS PROVNAME
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		TO_NUMBER(SUBSTR(A.DATE_CODE,6,2)) AS VAL1,
		NVL(SUM(ADD_MANPOW),0) AS
		VAL2
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON
		A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE
		-1,'YYYY-MM'),TO_CHAR(SYSDATE -1,'YYYY-MM-DD'),
		TO_CHAR(LAST_DAY(TO_DATE(A.DATE_CODE,'YYYY-MM-DD')),'YYYY-MM-DD') )
		GROUP BY D.PROVCOMCODE,TO_NUMBER(SUBSTR(A.DATE_CODE,6,2))
		),
		T3 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		TO_NUMBER(SUBSTR(A.DATE_CODE,6,2)) AS
		VAL1,
		NVL(SUM(PRO_STAD_PREM),0) AS VAL2,
		NVL(SUM(STAD_PREM),0) AS VAL3
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE &gt;=
		SUBSTR(#{end_time},1,4)||'-01-01'
		AND A.DATE_CODE &lt;=
		SUBSTR(#{end_time},1,7)||'-31'
		GROUP BY
		D.PROVCOMCODE,TO_NUMBER(SUBSTR(A.DATE_CODE,6,2))
		),
		T4 AS(
		SELECT
		T3.VAL0,
		NVL(SUM(DECODE(T2.VAL1,1,T2.VAL2,0)),0) AS VALA1,
		NVL(SUM(DECODE(T2.VAL1,1,T3.VAL2,0)),0) AS VALA2,
		NVL(SUM(DECODE(T2.VAL1,1,T3.VAL3,0)),0) AS VALA3,
		NVL(SUM(DECODE(T2.VAL1,2,T2.VAL2,0)),0) AS VALB1,
		NVL(SUM(DECODE(T2.VAL1,2,T3.VAL2,0)),0) AS VALB2,
		NVL(SUM(DECODE(T2.VAL1,2,T3.VAL3,0)),0) AS VALB3,
		NVL(SUM(DECODE(T2.VAL1,3,T2.VAL2,0)),0) AS VALC1,
		NVL(SUM(DECODE(T2.VAL1,3,T3.VAL2,0)),0) AS VALC2,
		NVL(SUM(DECODE(T2.VAL1,3,T3.VAL3,0)),0) AS VALC3,
		NVL(SUM(DECODE(T2.VAL1,4,T2.VAL2,0)),0) AS VALD1,
		NVL(SUM(DECODE(T2.VAL1,4,T3.VAL2,0)),0) AS VALD2,
		NVL(SUM(DECODE(T2.VAL1,4,T3.VAL3,0)),0) AS VALD3,
		NVL(SUM(DECODE(T2.VAL1,5,T2.VAL2,0)),0) AS VALE1,
		NVL(SUM(DECODE(T2.VAL1,5,T3.VAL2,0)),0) AS VALE2,
		NVL(SUM(DECODE(T2.VAL1,5,T3.VAL3,0)),0) AS VALE3,
		NVL(SUM(DECODE(T2.VAL1,6,T2.VAL2,0)),0) AS VALF1,
		NVL(SUM(DECODE(T2.VAL1,6,T3.VAL2,0)),0) AS VALF2,
		NVL(SUM(DECODE(T2.VAL1,6,T3.VAL3,0)),0) AS VALF3,
		NVL(SUM(DECODE(T2.VAL1,7,T2.VAL2,0)),0) AS VALG1,
		NVL(SUM(DECODE(T2.VAL1,7,T3.VAL2,0)),0) AS VALG2,
		NVL(SUM(DECODE(T2.VAL1,7,T3.VAL3,0)),0) AS VALG3,
		NVL(SUM(DECODE(T2.VAL1,8,T2.VAL2,0)),0) AS VALH1,
		NVL(SUM(DECODE(T2.VAL1,8,T3.VAL2,0)),0) AS VALH2,
		NVL(SUM(DECODE(T2.VAL1,8,T3.VAL3,0)),0) AS VALH3,
		NVL(SUM(DECODE(T2.VAL1,9,T2.VAL2,0)),0) AS VALI1,
		NVL(SUM(DECODE(T2.VAL1,9,T3.VAL2,0)),0) AS VALI2,
		NVL(SUM(DECODE(T2.VAL1,9,T3.VAL3,0)),0) AS VALI3,
		NVL(SUM(DECODE(T2.VAL1,10,T2.VAL2,0)),0) AS VALJ1,
		NVL(SUM(DECODE(T2.VAL1,10,T3.VAL2,0)),0) AS VALJ2,
		NVL(SUM(DECODE(T2.VAL1,10,T3.VAL3,0)),0) AS VALJ3,
		NVL(SUM(DECODE(T2.VAL1,11,T2.VAL2,0)),0) AS VALK1,
		NVL(SUM(DECODE(T2.VAL1,11,T3.VAL2,0)),0) AS VALK2,
		NVL(SUM(DECODE(T2.VAL1,11,T3.VAL3,0)),0) AS VALK3,
		NVL(SUM(DECODE(T2.VAL1,12,T2.VAL2,0)),0) AS VALL1,
		NVL(SUM(DECODE(T2.VAL1,12,T3.VAL2,0)),0) AS VALL2,
		NVL(SUM(DECODE(T2.VAL1,12,T3.VAL3,0)),0) AS VALL3,
		NVL(SUM(T2.VAL2),0)
		AS VALM1,
		NVL(SUM(T2.VAL1),0) AS VALM2,
		NVL(SUM(T2.VAL1),0) AS VALM3
		FROM T2 LEFT JOIN T3 ON T2.VAL0=T3.VAL0 AND T2.VAL1=T3.VAL1
		GROUP BY
		T3.VAL0
		),
		T5 AS (
		SELECT
		T1.PROVNAME AS VAL0,
		TRUNC(NVL(T4.VALA1,0)/100,2) AS VAL1,
		DECODE(NVL(T4.VALA3,0),0,0,TRUNC(NVL(T4.VALA2,0)/T4.VALA3*100,2)) AS
		VAL2,
		TRUNC(NVL(T4.VALB1,0)/100,2) AS VAL3,
		DECODE(NVL(T4.VALB3,0),0,0,TRUNC(NVL(T4.VALB2,0)/T4.VALB3*100,2)) AS
		VAL4,
		TRUNC(NVL(T4.VALC1,0)/100,2) AS VAL5,
		DECODE(NVL(T4.VALC3,0),0,0,TRUNC(NVL(T4.VALC2,0)/T4.VALC3*100,2)) AS
		VAL6,
		TRUNC(NVL(T4.VALD1,0)/100,2) AS VAL7,
		DECODE(NVL(T4.VALD3,0),0,0,TRUNC(NVL(T4.VALD2,0)/T4.VALD3*100,2)) AS
		VAL8,
		TRUNC(NVL(T4.VALE1,0)/100,2) AS VAL9,
		DECODE(NVL(T4.VALE3,0),0,0,TRUNC(NVL(T4.VALE2,0)/T4.VALE3*100,2)) AS
		VAL10,
		TRUNC(NVL(T4.VALF1,0)/100,2) AS VAL11,
		DECODE(NVL(T4.VALF3,0),0,0,TRUNC(NVL(T4.VALF2,0)/T4.VALF3*100,2)) AS
		VAL12,
		TRUNC(NVL(T4.VALG1,0)/100,2) AS VAL13,
		DECODE(NVL(T4.VALG3,0),0,0,TRUNC(NVL(T4.VALG2,0)/T4.VALG3*100,2)) AS
		VAL14,
		TRUNC(NVL(T4.VALH1,0)/100,2) AS VAL15,
		DECODE(NVL(T4.VALH3,0),0,0,TRUNC(NVL(T4.VALH2,0)/T4.VALH3*100,2)) AS
		VAL16,
		TRUNC(NVL(T4.VALI1,0)/100,2) AS VAL17,
		DECODE(NVL(T4.VALI3,0),0,0,TRUNC(NVL(T4.VALI2,0)/T4.VALI3*100,2)) AS
		VAL18,
		TRUNC(NVL(T4.VALJ1,0)/100,2) AS VAL19,
		DECODE(NVL(T4.VALJ3,0),0,0,TRUNC(NVL(T4.VALJ2,0)/T4.VALJ3*100,2)) AS
		VAL20,
		TRUNC(NVL(T4.VALK1,0)/100,2) AS VAL21,
		DECODE(NVL(T4.VALK3,0),0,0,TRUNC(NVL(T4.VALK2,0)/T4.VALK3*100,2)) AS
		VAL22,
		TRUNC(NVL(T4.VALL1,0)/100,2) AS VAL23,
		DECODE(NVL(T4.VALL3,0),0,0,TRUNC(NVL(T4.VALL2,0)/T4.VALL3*100,2)) AS
		VAL24,
		TRUNC(NVL(T4.VALM1,0)/100,2) AS VAL25,
		DECODE(NVL(T4.VALM3,0),0,0,TRUNC(NVL(T4.VALM2,0)/T4.VALM3*100,2)) AS
		VAL26
		FROM T1
		LEFT JOIN T4 ON T1.PROVCODE = T4.VAL0
		ORDER BY T1.PROVCODE
		)

		SELECT T5.VAL0,
		TRIM(TO_CHAR(T5.VAL1,'999999999999999999990.99')) AS
		VAL1,
		TRIM(TO_CHAR(T5.VAL2,'999999999999999999990.99')) AS VAL2,
		TRIM(TO_CHAR(T5.VAL3,'999999999999999999990.99')) AS VAL3,
		TRIM(TO_CHAR(T5.VAL4,'999999999999999999990.99')) AS VAL4,
		TRIM(TO_CHAR(T5.VAL5,'999999999999999999990.99')) AS VAL5,
		TRIM(TO_CHAR(T5.VAL6,'999999999999999999990.99')) AS VAL6,
		TRIM(TO_CHAR(T5.VAL7,'999999999999999999990.99')) AS VAL7,
		TRIM(TO_CHAR(T5.VAL8,'999999999999999999990.99')) AS VAL8,
		TRIM(TO_CHAR(T5.VAL9,'999999999999999999990.99')) AS VAL9,
		TRIM(TO_CHAR(T5.VAL10,'999999999999999999990.99')) AS VAL10,
		TRIM(TO_CHAR(T5.VAL11,'999999999999999999990.99')) AS VAL11,
		TRIM(TO_CHAR(T5.VAL12,'999999999999999999990.99')) AS VAL12,
		TRIM(TO_CHAR(T5.VAL13,'999999999999999999990.99')) AS VAL13,
		TRIM(TO_CHAR(T5.VAL14,'999999999999999999990.99')) AS VAL14,
		TRIM(TO_CHAR(T5.VAL15,'999999999999999999990.99')) AS VAL15,
		TRIM(TO_CHAR(T5.VAL16,'999999999999999999990.99')) AS VAL16,
		TRIM(TO_CHAR(T5.VAL17,'999999999999999999990.99')) AS VAL17,
		TRIM(TO_CHAR(T5.VAL18,'999999999999999999990.99')) AS VAL18,
		TRIM(TO_CHAR(T5.VAL19,'999999999999999999990.99')) AS VAL19,
		TRIM(TO_CHAR(T5.VAL20,'999999999999999999990.99')) AS VAL20,
		TRIM(TO_CHAR(T5.VAL21,'999999999999999999990.99')) AS VAL21,
		TRIM(TO_CHAR(T5.VAL22,'999999999999999999990.99')) AS VAL22,
		TRIM(TO_CHAR(T5.VAL23,'999999999999999999990.99')) AS VAL23,
		TRIM(TO_CHAR(T5.VAL24,'999999999999999999990.99')) AS VAL24,
		TRIM(TO_CHAR(T5.VAL25,'999999999999999999990.99')) AS VAL25,
		TRIM(TO_CHAR(T5.VAL26,'999999999999999999990.99')) AS VAL26
		FROM T5
		UNION ALL
		SELECT
		'全系统' AS VAL0,
		TRIM(TO_CHAR(NVL(SUM(T4.VALA1),0),'999999999999999999990.99')) AS
		VAL1,
		DECODE(NVL(SUM(T4.VALA3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALA2),0)/SUM(T4.VALA3)*100,2),'999999999999999999990.99')))
		AS VAL2,
		TRIM(TO_CHAR(NVL(SUM(T4.VALB1),0),'999999999999999999990.99')) AS
		VAL3,
		DECODE(NVL(SUM(T4.VALB3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALB2),0)/SUM(T4.VALB3)*100,2),'999999999999999999990.99')))
		AS VAL4,
		TRIM(TO_CHAR(NVL(SUM(T4.VALC1),0),'999999999999999999990.99')) AS
		VAL5,
		DECODE(NVL(SUM(T4.VALC3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALC2),0)/SUM(T4.VALC3)*100,2),'999999999999999999990.99')))
		AS VAL6,
		TRIM(TO_CHAR(NVL(SUM(T4.VALD1),0),'999999999999999999990.99')) AS
		VAL7,
		DECODE(NVL(SUM(T4.VALD3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALD2),0)/SUM(T4.VALD3)*100,2),'999999999999999999990.99')))
		AS VAL8,
		TRIM(TO_CHAR(NVL(SUM(T4.VALE1),0),'999999999999999999990.99')) AS
		VAL9,
		DECODE(NVL(SUM(T4.VALE3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALE2),0)/SUM(T4.VALE3)*100,2),'999999999999999999990.99')))
		AS VAL10,
		TRIM(TO_CHAR(NVL(SUM(T4.VALF1),0),'999999999999999999990.99')) AS
		VAL11,
		DECODE(NVL(SUM(T4.VALF3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALF2),0)/SUM(T4.VALF3)*100,2),'999999999999999999990.99')))
		AS VAL12,
		TRIM(TO_CHAR(NVL(SUM(T4.VALG1),0),'999999999999999999990.99')) AS
		VAL13,
		DECODE(NVL(SUM(T4.VALG3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALG2),0)/SUM(T4.VALG3)*100,2),'999999999999999999990.99')))
		AS VAL14,
		TRIM(TO_CHAR(NVL(SUM(T4.VALH1),0),'999999999999999999990.99')) AS
		VAL15,
		DECODE(NVL(SUM(T4.VALH3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALH2),0)/SUM(T4.VALH3)*100,2),'999999999999999999990.99')))
		AS VAL16,
		TRIM(TO_CHAR(NVL(SUM(T4.VALI1),0),'999999999999999999990.99')) AS
		VAL17,
		DECODE(NVL(SUM(T4.VALI3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALI2),0)/SUM(T4.VALI3)*100,2),'999999999999999999990.99')))
		AS VAL18,
		TRIM(TO_CHAR(NVL(SUM(T4.VALJ1),0),'999999999999999999990.99')) AS
		VAL19,
		DECODE(NVL(SUM(T4.VALJ3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALJ2),0)/SUM(T4.VALJ3)*100,2),'999999999999999999990.99')))
		AS VAL20,
		TRIM(TO_CHAR(NVL(SUM(T4.VALK1),0),'999999999999999999990.99')) AS
		VAL21,
		DECODE(NVL(SUM(T4.VALK3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALK2),0)/SUM(T4.VALK3)*100,2),'999999999999999999990.99')))
		AS VAL22,
		TRIM(TO_CHAR(NVL(SUM(T4.VALL1),0),'999999999999999999990.99')) AS
		VAL23,
		DECODE(NVL(SUM(T4.VALL3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALL2),0)/SUM(T4.VALL3)*100,2),'999999999999999999990.99')))
		AS VAL24,
		TRIM(TO_CHAR(NVL(SUM(T4.VALM1),0),'999999999999999999990.99')) AS
		VAL25,
		DECODE(NVL(SUM(T4.VALM3),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VALM2),0)/SUM(T4.VALM3)*100,2),'999999999999999999990.99')))
		AS VAL26
		FROM T1
		LEFT JOIN T4 ON T1.PROVCODE = T4.VAL0

	</select>
	<select id="R1301070006" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT 0 AS VAL0 WHERE DUAL WHERE 1=0
	</select>
	<select id="R1301070007" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT 0 AS VAL0 WHERE DUAL WHERE 1=0
	</select>
	<select id="R1301070008" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT 0 AS VAL0 WHERE DUAL WHERE 1=0
	</select>
	<select id="R1301070009" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.STAD_PREM),0) AS VAL1,NVL(SUM(A.RECE_STAD_PREM),0)
		AS VAL2
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN D_MANAGECOM D ON A.ORG_CODE =
		D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE = SUBSTR(#{end_time},1,7)
		GROUP
		BY D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.ACCE_STAD_PREM),0) AS VAL1,
		NVL(SUM(A.PRO_STAD_PREM),0) AS
		VAL2
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON
		A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		#{end_time}
		GROUP BY D.PROVCOMCODE
		),
		T5 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.ACCE_STAD_PREM),0) AS VAL1,
		NVL(SUM(A.PRO_STAD_PREM),0) AS
		VAL2
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON
		A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE &gt;=
		SUBSTR(#{end_time},1,7) || '-01'
		AND A.DATE_CODE &lt;=
		SUBSTR(#{end_time},1,7) || '-31'
		GROUP BY D.PROVCOMCODE
		),
		T6 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'MM'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt;=
		TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12)),'YYYY-MM-DD')
		GROUP BY D.PROVCOMCODE
		),
		T7 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;= SUBSTR(#{end_time},1,4) || '-01-01'
		GROUP BY
		D.PROVCOMCODE
		),
		T8 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'YY'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt; SUBSTR(#{end_time},1,4) || '-01-01'
		GROUP BY
		D.PROVCOMCODE
		),
		T9 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.STAD_PREM),0) AS VAL1,NVL(SUM(A.RECE_STAD_PREM),0)
		AS VAL2
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN D_MANAGECOM D ON A.ORG_CODE =
		D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE = SUBSTR(#{end_time},1,4)
		GROUP
		BY D.PROVCOMCODE
		),
		T11 AS(
		SELECT
		T1.VAL1 AS VAL0,
		NVL(T2.VAL1,0) AS VAL1,
		NVL(T4.VAL1,0) AS VAL2,
		NVL(T4.VAL2,0) AS VAL3,
		NVL(T5.VAL1,0) AS VAL4,
		DECODE(NVL(T2.VAL2,0),0,0,TRUNC(NVL(T5.VAL1,0)/T2.VAL2*100,2)) AS
		VAL5,
		NVL(T5.VAL2,0) AS VAL6,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC(NVL(T5.VAL2,0)/T2.VAL1*100,2)) AS
		VAL7,
		NVL(T6.VAL1,0) AS VAL8,
		DECODE(NVL(T6.VAL1,0),0,0,TRUNC((NVL(T5.VAL2,0)/T6.VAL1-1)*100,2)) AS
		VAL9,
		NVL(T7.VAL1,0) AS VAL10,
		DECODE(NVL(T9.VAL1,0),0,0,TRUNC(NVL(T7.VAL1,0)/T9.VAL1*100,2)) AS
		VAL11,
		DECODE(NVL(T8.VAL1,0),0,0,TRUNC((NVL(T7.VAL1,0)/T8.VAL1-1)*100,2)) AS
		VAL12
		FROM T1
		LEFT JOIN T2 ON T1.VAL0 = T2.VAL0
		LEFT JOIN T4 ON T1.VAL0 =
		T4.VAL0
		LEFT JOIN T5 ON T1.VAL0 = T5.VAL0
		LEFT JOIN T6 ON T1.VAL0 =
		T6.VAL0
		LEFT JOIN T7 ON T1.VAL0 = T7.VAL0
		LEFT JOIN T8 ON T1.VAL0 =
		T8.VAL0
		LEFT JOIN T9 ON T1.VAL0 = T9.VAL0
		ORDER BY 6 DESC
		)
		SELECT
		T11.VAL0,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL1,0)/1E4,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL2,0)/1E4,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL3,0)/1E4,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL4,0)/1E4,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(NVL(T11.VAL5,0),'999999999999999999990.99')) AS
		VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL6,0)/1E4,2),'999999999999999999990.99'))
		AS VAL6,
		TRIM(TO_CHAR(NVL(T11.VAL7,0),'999999999999999999990.99')) AS
		VAL7,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL8,0)/1E4,2),'999999999999999999990.99'))
		AS VAL8,
		TRIM(TO_CHAR(NVL(T11.VAL9,0),'999999999999999999990.99')) AS
		VAL9,
		TRIM(TO_CHAR(TRUNC(NVL(T11.VAL10,0)/1E4,2),'999999999999999999990.99'))
		AS VAL10,
		TRIM(TO_CHAR(NVL(T11.VAL11,0),'999999999999999999990.99')) AS
		VAL11,
		TRIM(TO_CHAR(NVL(T11.VAL12,0),'999999999999999999990.99')) AS
		VAL12
		FROM T11
		UNION ALL
		SELECT
		'全系统' AS VAL0,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL1),0)/1E4,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL1),0)/1E4,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL2),0)/1E4,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL1),0)/1E4,2),'999999999999999999990.99'))
		AS VAL4,
		DECODE(NVL(SUM(T2.VAL2),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL1),0)/SUM(T2.VAL2)*100,2),'999999999999999999990.99')))
		AS VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL2),0)/1E4,2),'999999999999999999990.99'))
		AS VAL6,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL2),0)/SUM(T2.VAL1)*100,2),'999999999999999999990.99')))
		AS VAL7,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T6.VAL1),0)/1E4,2),'999999999999999999990.99'))
		AS VAL8,
		DECODE(NVL(SUM(T6.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T5.VAL2),0)/SUM(T6.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL9,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T7.VAL1),0)/1E4,2),'999999999999999999990.99'))
		AS VAL10,
		DECODE(NVL(SUM(T9.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T7.VAL1),0)/SUM(T9.VAL1)*100,2),'999999999999999999990.99')))
		AS VAL11,
		DECODE(NVL(SUM(T8.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T7.VAL1),0)/SUM(T8.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL12
		FROM T1
		LEFT JOIN T2 ON T1.VAL0 = T2.VAL0
		LEFT JOIN T4 ON
		T1.VAL0 = T4.VAL0
		LEFT JOIN T5 ON T1.VAL0 = T5.VAL0
		LEFT JOIN T6 ON
		T1.VAL0 = T6.VAL0
		LEFT JOIN T7 ON T1.VAL0 = T7.VAL0
		LEFT JOIN T8 ON
		T1.VAL0 = T8.VAL0
		LEFT JOIN T9 ON T1.VAL0 = T9.VAL0

	</select>
	<select id="R1301070010" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS (
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.RECE_EFF_NUM),0) AS VAL1
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.ORG_CODE = D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		SUBSTR(#{end_time},1,4)
		GROUP BY D.PROVCOMCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.YX_ACCE_MANPOW_NUM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.YX_ACCE_MANPOW_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(TO_DATE(A.DATE_CODE,'YYYY-MM-DD'),'YYYY-MM-DD'))
		GROUP BY
		D.PROVCOMCODE
		),
		T5 AS (
		SELECT
		T1.VAL1 AS VAL0,
		NVL(T2.VAL1,0) AS VAL1,
		NVL(T3.VAL1,0) AS VAL2,
		DECODE(NVL(T4.VAL1,0),0,0,TRUNC(NVL(T3.VAL1,0)/T4.VAL1*100,2)) AS
		VAL3,
		NVL(T4.VAL1,0) AS VAL4,
		NVL(T2.VAL1,0)-NVL(T4.VAL1,0) AS VAL5,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC((NVL(T4.VAL1,0)/T2.VAL1-1)*100,2)) AS
		VAL6
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0
		ORDER BY 7 DESC
		)

		SELECT
		T5.VAL0,
		TRIM(TO_CHAR(TRUNC(NVL(T5.VAL1,0)/100,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(T5.VAL2,0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(NVL(T5.VAL3,0),'999999999999999999990.99')) AS
		VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(T5.VAL4,0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(TRUNC(NVL(T5.VAL5,0)/100,2),'999999999999999999990.99'))
		AS VAL5,
		TRIM(TO_CHAR(NVL(T5.VAL6,0),'999999999999999999990.99')) AS
		VAL6
		FROM T5
		UNION ALL
		SELECT
		'全系统' AS VAL0,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		DECODE(NVL(SUM(T4.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL1),0)/SUM(T4.VAL1)*100,2),'999999999999999999990.99')))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(TRUNC((NVL(SUM(T2.VAL1),0)-NVL(SUM(T4.VAL1),0))/100,2),'999999999999999999990.99'))
		AS VAL5,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T4.VAL1),0)/SUM(T2.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL6
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0

	</select>
	<select id="R1301070011" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.RECE_PRE_GOLD_BEE_NUM),0) AS VAL1
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN D_MANAGECOM D ON A.ORG_CODE = D.PROVCOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE = SUBSTR(#{end_time},1,4)
		GROUP BY D.PROVCOMCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.FINAL_MANAGER_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE
		= D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.MANA_ACH_QUA_GOLD_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE = #{end_time}
		GROUP BY D.PROVCOMCODE
		),
		T5 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.MANA_ACH_QUA_GOLD_NUM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(TO_DATE(A.DATE_CODE,'YYYY-MM-DD'),'YYYY-MM-DD'))
		GROUP BY
		D.PROVCOMCODE
		),
		T6 AS (
		SELECT
		T1.VAL1 AS VAL1,
		NVL(T2.VAL1,0) AS VAL2,
		NVL(T3.VAL1,0) AS VAL3,
		NVL(T4.VAL1,0) AS VAL4,
		DECODE(NVL(T3.VAL1,0),0,0,TRUNC(NVL(T4.VAL1,0)/T3.VAL1*100,2)) AS
		VAL5,
		NVL(T5.VAL1,0) AS VAL6,
		NVL(T2.VAL1,0)-NVL(T5.VAL1,0) AS VAL7,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC((NVL(T5.VAL1,0)/T2.VAL1-1)*100,2)) AS
		VAL8
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0
		LEFT JOIN T5 ON
		T1.VAL0=T5.VAL0
		ORDER BY 8 DESC
		)

		SELECT ROWNUM AS VAL0,T7.*
		FROM(
		SELECT
		T6.VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL2,0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL3,0)/100,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL4,0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		TRIM(TO_CHAR(NVL(T6.VAL5,0),'999999999999999999990.99')) AS
		VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL6,0)/100,2),'999999999999999999990.99'))
		AS VAL6,
		TRIM(TO_CHAR(TRUNC(NVL(T6.VAL7,0)/100,2),'999999999999999999990.99'))
		AS VAL7,
		TRIM(TO_CHAR(NVL(T6.VAL8,0),'999999999999999999990.99')) AS
		VAL8
		FROM T6
		UNION ALL
		SELECT
		'全系统' AS VAL1,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T2.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL2,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T3.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL3,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL4,
		DECODE(NVL(SUM(T3.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC(NVL(SUM(T4.VAL1),0)/SUM(T3.VAL1)*100,2),'999999999999999999990.99')))
		AS VAL5,
		TRIM(TO_CHAR(TRUNC(NVL(SUM(T5.VAL1),0)/100,2),'999999999999999999990.99'))
		AS VAL6,
		TRIM(TO_CHAR(TRUNC((NVL(SUM(T2.VAL1),0)-NVL(SUM(T5.VAL1),0))/100,2),'999999999999999999990.99'))
		AS VAL7,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T5.VAL1),0)/SUM(T2.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL8
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0
		LEFT JOIN T5 ON
		T1.VAL0=T5.VAL0
		) T7

	</select>
	<select id="R1301070012" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.IN_MANPOW),0) AS VAL1
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(TO_DATE(A.DATE_CODE,'YYYY-MM-DD'),'YYYY-MM-DD'))
		GROUP BY
		D.PROVCOMCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.IN_MANPOW),0) AS VAL1
		FROM HT_ORG_DEVE_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'MM'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt;=
		TO_CHAR(LAST_DAY(TO_DATE(#{end_time},'YYYY-MM-DD')),'YYYY-MM-DD')
		GROUP
		BY D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		T1.VAL1 AS VAL1,
		T2.VAL1 AS VAL2,
		T3.VAL1 AS VAL3,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC((NVL(T3.VAL1,0)/T2.VAL1-1)*100,2)) AS
		VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		ORDER BY 4 DESC
		)
		SELECT ROWNUM AS VAL0,T5.* FROM (
		SELECT
		T4.VAL1,
		TRIM(TO_CHAR(TRUNC(T4.VAL2/100,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(T4.VAL3/100,2),'999999999999999999990.99')) AS
		VAL3,
		TRIM(TO_CHAR(T4.VAL4,'999999999999999999990.99')) AS VAL4
		FROM T4
		UNION ALL
		SELECT
		'全公司' AS VAL1,
		TRIM(TO_CHAR(SUM(T2.VAL1),'999999999999999999990.99')) AS VAL2,
		TRIM(TO_CHAR(SUM(T3.VAL1),'999999999999999999990.99')) AS VAL3,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T3.VAL1),0)/SUM(T2.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		) T5

	</select>
	<select id="R1301070013" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PL_MANPOW_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(TO_DATE(A.DATE_CODE,'YYYY-MM-DD'),'YYYY-MM-DD'))
		GROUP BY
		D.PROVCOMCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PL_MANPOW_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'MM'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt;=
		TO_CHAR(LAST_DAY(TO_DATE(#{end_time},'YYYY-MM-DD')),'YYYY-MM-DD')
		GROUP
		BY D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		T1.VAL1 AS VAL1,
		T2.VAL1 AS VAL2,
		T3.VAL1 AS VAL3,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC((NVL(T3.VAL1,0)/T2.VAL1-1)*100,2)) AS
		VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		ORDER BY 4 DESC
		)
		SELECT ROWNUM AS VAL0,T5.* FROM (
		SELECT
		T4.VAL1,
		TRIM(TO_CHAR(TRUNC(T4.VAL2/100,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(T4.VAL3/100,2),'999999999999999999990.99')) AS
		VAL3,
		TRIM(TO_CHAR(T4.VAL4,'999999999999999999990.99')) AS VAL4
		FROM T4
		UNION ALL
		SELECT
		'全公司' AS VAL1,
		TRIM(TO_CHAR(SUM(T2.VAL1),'999999999999999999990.99')) AS VAL2,
		TRIM(TO_CHAR(SUM(T3.VAL1),'999999999999999999990.99')) AS VAL3,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T3.VAL1),0)/SUM(T2.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		) T5

	</select>
	<select id="R1301070014" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.YX_MANPOW_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE =
		DECODE(SUBSTR(#{end_time},1,7),TO_CHAR(SYSDATE-1,'YYYY-MM'),TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),
		TO_CHAR(TO_DATE(A.DATE_CODE,'YYYY-MM-DD'),'YYYY-MM-DD'))
		GROUP BY
		D.PROVCOMCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.YX_MANPOW_NUM),0) AS VAL1
		FROM HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'MM'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt;=
		TO_CHAR(LAST_DAY(TO_DATE(#{end_time},'YYYY-MM-DD')),'YYYY-MM-DD')
		GROUP
		BY D.PROVCOMCODE
		),
		T4 AS (
		SELECT
		T1.VAL1 AS VAL1,
		T2.VAL1 AS VAL2,
		T3.VAL1 AS VAL3,
		DECODE(NVL(T2.VAL1,0),0,0,TRUNC((NVL(T3.VAL1,0)/T2.VAL1-1)*100,2)) AS
		VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		ORDER BY 4 DESC
		)
		SELECT ROWNUM AS VAL0,T5.* FROM (
		SELECT
		T4.VAL1,
		TRIM(TO_CHAR(TRUNC(T4.VAL2/100,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(T4.VAL3/100,2),'999999999999999999990.99')) AS
		VAL3,
		TRIM(TO_CHAR(T4.VAL4,'999999999999999999990.99')) AS VAL4
		FROM T4
		UNION ALL
		SELECT
		'全公司' AS VAL1,
		TRIM(TO_CHAR(SUM(T2.VAL1),'999999999999999999990.99')) AS VAL2,
		TRIM(TO_CHAR(SUM(T3.VAL1),'999999999999999999990.99')) AS VAL3,
		DECODE(NVL(SUM(T2.VAL1),0),0,'0',TRIM(TO_CHAR(TRUNC((NVL(SUM(T3.VAL1),0)/SUM(T2.VAL1)-1)*100,2),'999999999999999999990.99')))
		AS VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0
		) T5

	</select>
	<select id="R1301070015" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.STAD_PREM),0) AS VAL1
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.ORG_CODE = D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		SUBSTR(#{end_time},1,4)
		GROUP BY D.PROVCOMCODE
		),
		T4 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND A.DATE_CODE &gt;= SUBSTR(#{end_time},1,4)
		|| '-01-01'
		AND A.DATE_CODE &lt;= SUBSTR(#{end_time},1,4) || '-12-31'
		GROUP BY D.PROVCOMCODE
		),
		T5 AS (
		SELECT
		T1.VAL0 AS VAL0,
		T1.VAL1 AS VAL1,
		NVL(T2.VAL1,0) AS VAL2,
		NVL(T4.VAL1,0) AS VAL3
		FROM T1
		LEFT JOIN T2 ON
		T1.VAL0=T2.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0
		)

		SELECT ROWNUM AS
		VAL0,XY.* FROM (
		SELECT * FROM (
		SELECT
		T5.VAL1,
		TRIM(TO_CHAR(TRUNC(T5.VAL2/1E4,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(T5.VAL3/1E4,2),'999999999999999999990.99')) AS
		VAL3,
		DECODE(T5.VAL2,0,'0',TRIM(TO_CHAR(TRUNC(T5.VAL3/T5.VAL2*100,2),'999999999999999999990.99')))
		AS VAL4
		FROM T5
		ORDER BY 4 DESC
		) X
		UNION ALL
		SELECT * FROM (
		SELECT
		'全司' AS
		VAL1,
		TRIM(TO_CHAR(TRUNC(SUM(T5.VAL2)/1E4,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(SUM(T5.VAL3)/1E4,2),'999999999999999999990.99')) AS
		VAL3,
		DECODE(SUM(T5.VAL2),0,'0',TRIM(TO_CHAR(TRUNC(SUM(T5.VAL3)/SUM(T5.VAL2)*100,2),'999999999999999999990.99')))
		AS VAL4
		FROM T5
		) Y
		) XY


	</select>
	<select id="R1301070016" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		PROVCOMCODE AS
		VAL0,TEAMCOMSHORTNAME AS VAL1
		FROM D_MANAGECOM D WHERE 1=1
		AND
		D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		ORDER BY 1
		),
		T2 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.STAD_PREM),0) AS VAL1
		FROM HT_RISK_TARGET_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.ORG_CODE = D.PROVCOMCODE
		WHERE 1=1
		AND A.DATE_CODE =
		SUBSTR(#{end_time},1,7)
		GROUP BY D.PROVCOMCODE
		),
		T4 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;= SUBSTR(#{end_time},1,7)
		|| '-01'
		AND A.DATE_CODE
		&lt;= SUBSTR(#{end_time},1,7) || '-31'
		GROUP BY
		D.PROVCOMCODE
		),
		T5 AS(
		SELECT
		D.PROVCOMCODE AS VAL0,
		NVL(SUM(A.PRO_STAD_PREM),0) AS VAL1
		FROM
		HT_PREM_REAC_DAY_TB A
		LEFT JOIN
		D_MANAGECOM D ON A.MANAGECOM_CODE =
		D.MANAGECOMCODE
		WHERE 1=1
		AND
		A.DATE_CODE &gt;=
		TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12),'MM'),'YYYY-MM-DD')
		AND A.DATE_CODE &lt;=
		TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12)),'YYYY-MM-DD')
		GROUP BY D.PROVCOMCODE
		),
		T6 AS (
		SELECT
		T1.VAL0 AS VAL0,
		T1.VAL1 AS VAL1,
		NVL(T2.VAL1,0) AS VAL2,
		NVL(T4.VAL1,0) AS VAL3,
		NVL(T5.VAL1,0) AS VAL4
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0
		LEFT JOIN T5 ON T1.VAL0=T5.VAL0
		)

		SELECT ROWNUM AS VAL0,XY.* FROM (
		SELECT * FROM (
		SELECT
		T6.VAL1,
		TRIM(TO_CHAR(TRUNC(T6.VAL2/1E4,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(T6.VAL3/1E4,2),'999999999999999999990.99')) AS
		VAL3,
		DECODE(T6.VAL2,0,'0',TRIM(TO_CHAR(TRUNC(T6.VAL3/T6.VAL2*100,2),'999999999999999999990.99')))
		AS VAL4,
		TRIM(TO_CHAR(T6.VAL4,'999999999999999999990.99')) AS VAL5,
		DECODE(T6.VAL3,0,'0',TRIM(TO_CHAR(TRUNC((T6.VAL4/T6.VAL3-1)*100,2),'999999999999999999990.99')))
		AS VAL6
		FROM T6
		ORDER BY 4 DESC
		) X
		UNION ALL
		SELECT * FROM (
		SELECT
		'全司' AS
		VAL1,
		TRIM(TO_CHAR(TRUNC(SUM(T6.VAL2)/1E4,2),'999999999999999999990.99')) AS
		VAL2,
		TRIM(TO_CHAR(TRUNC(SUM(T6.VAL3)/1E4,2),'999999999999999999990.99')) AS
		VAL3,
		DECODE(SUM(T6.VAL2),0,'0',TRIM(TO_CHAR(TRUNC(SUM(T6.VAL3)/SUM(T6.VAL2)*100,2),'999999999999999999990.99')))
		AS VAL4,
		TRIM(TO_CHAR(SUM(T6.VAL4),'999999999999999999990.99')) AS
		VAL5,
		DECODE(SUM(T6.VAL3),0,'0',TRIM(TO_CHAR(TRUNC((SUM(T6.VAL4)/SUM(T6.VAL3)-1)*100,2),'999999999999999999990.99')))
		AS VAL6
		FROM T6
		) Y
		) XY


	</select>

	<select id="R1301010001" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		D.PROVCOMCODE AS VAL0,D.TEAMCOMSHORTNAME AS
		VAL00,
		D.COUNTCOMCODE AS VAL1,D.ACTUTEAMCOMSHORTNAME AS VAL11
		FROM
		D_MANAGECOM D
		WHERE 1=1
		AND D.HEADCOMCODE = '1' AND D.PROVCOMCODE IS NOT
		NULL AND D.PROVCOMCODE
		&lt;&gt; '1'
		AND ( D.COUNTCOMCODE &lt;&gt; D.PROVCOMCODE OR
		D.COUNTCOMCODE= '101' )
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		ORDER BY 1
		),
		T2 AS (
		<!-- 达标机构数量（日值） 首次承保时间（日值） 天值： -->
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		MIN(A.FIRST_INSURE_TIME) AS VAL2
		FROM HT_THREE_ORG_GRADE_DAY_TB A
		LEFT
		JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		AND
		D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
		GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T3 AS (
		<!-- 个险（预）评级 辖下机构（时点值） 机构达标率（时点值） 标保 月均（时点值）标保 合计（时点值） 折算有效人力 月均（时点值） 折算有效人力 
			合计（时点值） K2（时点值） 时点值： -->
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		MAX(A.GRADE) AS
		VAL2,
		SUM(A.FOUR_ORG_NUM) AS VAL3,
		SUM(A.E_FOUR_ORG_NUM) AS VAL31,
		NVL(SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))),0) VAL5M,
		NVL(SUM(A.SUM_PREM),0) VAL5Z,
		SUM(A.SUM_PREM) AS VAL6,
		NVL(SUM(A.MONTH_MANPOVER_CONV_TOTAL),0) AS VAL7Z,
		NVL(SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))),0) AS VAL7M,
		SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL8,
		NVL(SUM(A.SHOU_K2),0) AS
		VAL9M,
		NVL(SUM(A.FACT_K2),0) AS VAL9Z
		FROM HT_THREE_ORG_GRADE_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND D.HEADCOMCODE = '1'
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T4 AS
		(
		<!-- 上次评级结果 -->
		SELECT D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		MAX(A.GRADE) AS
		VAL2
		FROM HT_THREE_ORG_GRADE_DAY_TB A
		LEFT JOIN D_MANAGECOM D ON
		A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE 1=1
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND D.HEADCOMCODE = '1'
		AND A.DATE_CODE =
		TO_CHAR(TO_NUMBER(SUBSTR(#{end_time},1,4))-1) || '-12-31'
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T5 AS (
		<!-- 机构,月分组 -->
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		TO_NUMBER(SUBSTR(A.DATE_CODE,6,2)) AS VAL2,
		SUM(A.MONTH_STA_PREM) AS
		VAL3,
		SUM(A.MONTH_MANPOVER_CONV) AS VAL4
		FROM HT_THREE_ORG_GRADE_DAY_TB
		A
		LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		WHERE
		1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND ((A.DATE_CODE =#{end_time}
		OR A.DATE_CODE =
		TO_CHAR(SYSDATE-1,'YYYY-MM-DD'))
		OR A.DATE_CODE =
		TO_CHAR(LAST_DAY(TO_DATE(A.DATE_CODE,'YYYY-MM-DD')),'YYYY-MM-DD'))
		AND
		A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
		GROUP
		BY
		D.PROVCOMCODE,D.COUNTCOMCODE,TO_NUMBER(SUBSTR(A.DATE_CODE,6,2))
		),
		T6
		AS
		(
		<!-- 机构,1-12月 -->
		SELECT
		T5.VAL0 AS VAL0,
		T5.VAL1 AS VAL1,
		SUM(DECODE(T5.VAL2,1,T5.VAL3,0)) AS BB01,
		SUM(DECODE(T5.VAL2,1,T5.VAL4,0)) AS ZS01,
		SUM(DECODE(T5.VAL2,2,T5.VAL3,0)) AS BB02,
		SUM(DECODE(T5.VAL2,2,T5.VAL4,0)) AS ZS02,
		SUM(DECODE(T5.VAL2,3,T5.VAL3,0)) AS BB03,
		SUM(DECODE(T5.VAL2,3,T5.VAL4,0)) AS ZS03,
		SUM(DECODE(T5.VAL2,4,T5.VAL3,0)) AS BB04,
		SUM(DECODE(T5.VAL2,4,T5.VAL4,0)) AS ZS04,
		SUM(DECODE(T5.VAL2,5,T5.VAL3,0)) AS BB05,
		SUM(DECODE(T5.VAL2,5,T5.VAL4,0)) AS ZS05,
		SUM(DECODE(T5.VAL2,6,T5.VAL3,0)) AS BB06,
		SUM(DECODE(T5.VAL2,6,T5.VAL4,0)) AS ZS06,
		SUM(DECODE(T5.VAL2,7,T5.VAL3,0)) AS BB07,
		SUM(DECODE(T5.VAL2,7,T5.VAL4,0)) AS ZS07,
		SUM(DECODE(T5.VAL2,8,T5.VAL3,0)) AS BB08,
		SUM(DECODE(T5.VAL2,8,T5.VAL4,0)) AS ZS08,
		SUM(DECODE(T5.VAL2,9,T5.VAL3,0)) AS BB09,
		SUM(DECODE(T5.VAL2,9,T5.VAL4,0)) AS ZS09,
		SUM(DECODE(T5.VAL2,10,T5.VAL3,0)) AS BB10,
		SUM(DECODE(T5.VAL2,10,T5.VAL4,0)) AS ZS10,
		SUM(DECODE(T5.VAL2,11,T5.VAL3,0)) AS BB11,
		SUM(DECODE(T5.VAL2,11,T5.VAL4,0)) AS ZS11,
		SUM(DECODE(T5.VAL2,12,T5.VAL3,0)) AS BB12,
		SUM(DECODE(T5.VAL2,12,T5.VAL4,0)) AS ZS12
		FROM T5
		GROUP BY
		T5.VAL0,T5.VAL1
		),

		T7 AS (
		SELECT
		T1.VAL00 AS VAL1,
		T1.VAL11 AS VAL2,
		T2.VAL2 AS VAL3,
		T4.VAL2 AS VAL4,
		T3.VAL2 AS VAL5,
		T3.VAL3 AS VAL6,
		T3.VAL31 AS VAL7,
		T3.VAL31 AS VAL8Z,
		T3.VAL3 AS VAL8M,
		TRUNC(T6.BB01/10000,2) AS VAL9,
		TRUNC(T6.BB02/10000,2) AS VAL10,
		TRUNC(T6.BB03/10000,2) AS VAL11,
		TRUNC(T6.BB04/10000,2) AS VAL12,
		TRUNC(T6.BB05/10000,2) AS VAL13,
		TRUNC(T6.BB06/10000,2) AS VAL14,
		TRUNC(T6.BB07/10000,2) AS VAL15,
		TRUNC(T6.BB08/10000,2) AS VAL16,
		TRUNC(T6.BB09/10000,2) AS VAL17,
		TRUNC(T6.BB10/10000,2) AS VAL18,
		TRUNC(T6.BB11/10000,2) AS VAL19,
		TRUNC(T6.BB12/10000,2) AS VAL20,
		DECODE(T3.VAL5M,0,TO_NUMBER(''),T3.VAL5Z/T3.VAL5M) RN,
		T3.VAL5M AS
		VAL21M,
		T3.VAL5Z AS VAL21Z,
		TRUNC(T3.VAL6/10000,2) AS VAL22,
		TRUNC(T6.ZS01/100,2) AS VAL23,
		TRUNC(T6.ZS02/100,2) AS VAL24,
		TRUNC(T6.ZS03/100,2) AS VAL25,
		TRUNC(T6.ZS04/100,2) AS VAL26,
		TRUNC(T6.ZS05/100,2) AS VAL27,
		TRUNC(T6.ZS06/100,2) AS VAL28,
		TRUNC(T6.ZS07/100,2) AS VAL29,
		TRUNC(T6.ZS08/100,2) AS VAL30,
		TRUNC(T6.ZS09/100,2) AS VAL31,
		TRUNC(T6.ZS10/100,2) AS VAL32,
		TRUNC(T6.ZS11/100,2) AS VAL33,
		TRUNC(T6.ZS12/100,2) AS VAL34,
		T3.VAL7Z
		AS VAL35Z,
		T3.VAL7M AS VAL35M,
		TRUNC(T3.VAL8/100,2) AS VAL36,
		T3.VAL9Z AS
		VAL37Z,
		T3.VAL9M AS VAL37M
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0 AND
		T1.VAL1=T2.VAL1
		LEFT JOIN T3 ON
		T1.VAL0=T3.VAL0 AND T1.VAL1=T3.VAL1
		LEFT
		JOIN T4 ON T1.VAL0=T4.VAL0 AND
		T1.VAL1=T4.VAL1
		LEFT JOIN T6 ON
		T1.VAL0=T6.VAL0 AND T1.VAL1=T6.VAL1
		<if test="orderby5!=null"><!-- 2017年个险评级升序 -->
			ORDER BY 5
		</if>
		<if test="orderby21!=null"><!-- 2017年实际月均标保降序 -->
			ORDER BY 21 DESC NULLS LAST
		</if>
		)
		SELECT
		ROWNUM AS VAL0,
		T7.VAL1 AS VAL1,
		T7.VAL2 AS VAL2,
		NVL(T7.VAL3,'--') AS VAL3,
		DECODE(T7.VAL4,'','--',T7.VAL4) AS VAL4,
		DECODE(T7.VAL5,'','--',T7.VAL5) AS VAL5,
		DECODE(T7.VAL6,'','--',T7.VAL6) AS VAL6,
		DECODE(T7.VAL7,'','--',T7.VAL7) AS VAL7,
		DECODE(NVL(T7.VAL8M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL8Z,0)/T7.VAL8M*100,2),'99999999999999999999999990.99'))
		|| '%') AS VAL8,
		DECODE(T7.VAL9,'','--',TRIM(TO_CHAR(T7.VAL9,'99999999999999999999999990.99'))
		|| '万元') AS VAL9,
		DECODE(T7.VAL10,'','--',TRIM(TO_CHAR(T7.VAL10,'99999999999999999999999990.99'))
		|| '万元') AS VAL10,
		DECODE(T7.VAL11,'','--',TRIM(TO_CHAR(T7.VAL11,'99999999999999999999999990.99'))
		|| '万元') AS VAL11,
		DECODE(T7.VAL12,'','--',TRIM(TO_CHAR(T7.VAL12,'99999999999999999999999990.99'))
		|| '万元') AS VAL12,
		DECODE(T7.VAL13,'','--',TRIM(TO_CHAR(T7.VAL13,'99999999999999999999999990.99'))
		|| '万元') AS VAL13,
		DECODE(T7.VAL14,'','--',TRIM(TO_CHAR(T7.VAL14,'99999999999999999999999990.99'))
		|| '万元') AS VAL14,
		DECODE(T7.VAL15,'','--',TRIM(TO_CHAR(T7.VAL15,'99999999999999999999999990.99'))
		|| '万元') AS VAL15,
		DECODE(T7.VAL16,'','--',TRIM(TO_CHAR(T7.VAL16,'99999999999999999999999990.99'))
		|| '万元') AS VAL16,
		DECODE(T7.VAL17,'','--',TRIM(TO_CHAR(T7.VAL17,'99999999999999999999999990.99'))
		|| '万元') AS VAL17,
		DECODE(T7.VAL18,'','--',TRIM(TO_CHAR(T7.VAL18,'99999999999999999999999990.99'))
		|| '万元') AS VAL18,
		DECODE(T7.VAL19,'','--',TRIM(TO_CHAR(T7.VAL19,'99999999999999999999999990.99'))
		|| '万元') AS VAL19,
		DECODE(T7.VAL20,'','--',TRIM(TO_CHAR(T7.VAL20,'99999999999999999999999990.99'))
		|| '万元') AS VAL20,
		DECODE(NVL(T7.VAL21M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL21Z,0)/T7.VAL21M/10000,2),'99999999999999999999999990.99'))
		|| '万元') AS VAL21,
		DECODE(T7.VAL22,'','--',TRIM(TO_CHAR(T7.VAL22,'99999999999999999999999990.99'))
		|| '万元') AS VAL22,
		DECODE(T7.VAL23,'','--',TRIM(TO_CHAR(T7.VAL23,'99999999999999999999999990.99'))
		|| '百人') AS VAL23,
		DECODE(T7.VAL24,'','--',TRIM(TO_CHAR(T7.VAL24,'99999999999999999999999990.99'))
		|| '百人') AS VAL24,
		DECODE(T7.VAL25,'','--',TRIM(TO_CHAR(T7.VAL25,'99999999999999999999999990.99'))
		|| '百人') AS VAL25,
		DECODE(T7.VAL26,'','--',TRIM(TO_CHAR(T7.VAL26,'99999999999999999999999990.99'))
		|| '百人') AS VAL26,
		DECODE(T7.VAL27,'','--',TRIM(TO_CHAR(T7.VAL27,'99999999999999999999999990.99'))
		|| '百人') AS VAL27,
		DECODE(T7.VAL28,'','--',TRIM(TO_CHAR(T7.VAL28,'99999999999999999999999990.99'))
		|| '百人') AS VAL28,
		DECODE(T7.VAL29,'','--',TRIM(TO_CHAR(T7.VAL29,'99999999999999999999999990.99'))
		|| '百人') AS VAL29,
		DECODE(T7.VAL30,'','--',TRIM(TO_CHAR(T7.VAL30,'99999999999999999999999990.99'))
		|| '百人') AS VAL30,
		DECODE(T7.VAL31,'','--',TRIM(TO_CHAR(T7.VAL31,'99999999999999999999999990.99'))
		|| '百人') AS VAL31,
		DECODE(T7.VAL32,'','--',TRIM(TO_CHAR(T7.VAL32,'99999999999999999999999990.99'))
		|| '百人') AS VAL32,
		DECODE(T7.VAL33,'','--',TRIM(TO_CHAR(T7.VAL33,'99999999999999999999999990.99'))
		|| '百人') AS VAL33,
		DECODE(T7.VAL34,'','--',TRIM(TO_CHAR(T7.VAL34,'99999999999999999999999990.99'))
		|| '百人') AS VAL34,
		DECODE(NVL(T7.VAL35M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL35Z,0)/T7.VAL35M/100,2),'99999999999999999999999990.99'))
		|| '百人') AS VAL35,
		DECODE(T7.VAL36,'','--',TRIM(TO_CHAR(T7.VAL36,'99999999999999999999999990.99'))
		|| '百人') AS VAL36,
		DECODE(NVL(T7.VAL37M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL37Z,0)/T7.VAL37M*100,2),'99999999999999999999999990.99'))
		|| '%') AS VAL37
		FROM T7

	</select>
	<select id="R1301010002" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		D.PROVCOMCODE AS VAL0,D.TEAMCOMSHORTNAME AS
		VAL00,
		D.COUNTCOMCODE AS VAL1,D.ACTUTEAMCOMSHORTNAME AS VAL11,
		D.COST_CENTERSTDCODE AS VAL2,D.COST_CENTERDEVNAME AS VAL22
		FROM
		D_ORGANIZATION D
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		AND D.PROVCOMCODE IS
		NOT NULL AND
		D.PROVCOMCODE &lt;&gt; '1'
		AND ( D.COUNTCOMCODE &lt;&gt; D.PROVCOMCODE
		OR
		D.COUNTCOMCODE= '101' )
		AND D.COST_CENTERSTDCODE IS NOT NULL
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		ORDER BY 1
		),
		T2 AS (
		<!-- 首次承保时间（日值）天值： -->
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MIN(A.FIRST_INSURE_TIME) AS VAL3
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		LEFT JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE!='1'
		) D
		ON
		A.GROUP_CODE = D.COST_CENTERSTDCODE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
		GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MAX(A.AGENCY_SIGN) AS VAL3,
		MAX(A.GRADE)
		AS VAL4,
		SUM(A.SUM_PREM) AS VAL5Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL5M,
		SUM(A.SUM_PREM) AS VAL6,
		SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL7Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL7M,
		SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL8,
		SUM(A.FACT_K2) AS VAL9Z,
		SUM(A.SHOU_K2) AS VAL9M
		FROM HT_FOUR_ORG_GRADE_DAY_TB A
		LEFT JOIN
		(SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE
		PROVCOMCODE!='1' ) D
		ON A.GROUP_CODE = D.COST_CENTERSTDCODE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T4 AS (
		<!-- 上次评级结果 -->
		SELECT D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MAX(A.GRADE) AS VAL3
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		LEFT JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE!='1'
		) D
		ON
		A.GROUP_CODE = D.COST_CENTERSTDCODE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = (CASE WHEN SUBSTR(#{end_time},6,2) &lt; '07'
		THEN
		TO_CHAR(TO_NUMBER(SUBSTR(#{end_time},1,4))-1) || '-12-31'
		ELSE
		SUBSTR(#{end_time},1,4) || '-06-30' END )
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T5 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS
		VAL2,
		TO_NUMBER(SUBSTR(A.DATE_CODE,6,2)) AS VAL3,
		SUM(A.MONTH_STA_PREM)
		AS VAL4,
		SUM(A.MONTH_MANPOVER_CONV) AS VAL5
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		LEFT JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE!='1'
		) D
		ON
		A.GROUP_CODE = D.COST_CENTERSTDCODE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND ((A.DATE_CODE = #{end_time}
		OR
		A.DATE_CODE=TO_CHAR(SYSDATE-1,'YYYY-MM-DD'))
		OR
		A.DATE_CODE=TO_CHAR(LAST_DAY(TO_DATE(A.DATE_CODE,'YYYY-MM-DD')),'YYYY-MM-DD'))
		AND A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
		GROUP
		BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE,TO_NUMBER(SUBSTR(A.DATE_CODE,6,2))
		),
		T6 AS (
		SELECT
		T5.VAL0 AS VAL0 ,
		T5.VAL1 AS VAL1,
		T5.VAL2 AS VAL2,
		SUM(DECODE(T5.VAL3,1,T5.VAL4,0)) AS BB01,
		SUM(DECODE(T5.VAL3,1,T5.VAL5,0)) AS ZS01,
		SUM(DECODE(T5.VAL3,2,T5.VAL4,0)) AS BB02,
		SUM(DECODE(T5.VAL3,2,T5.VAL5,0)) AS ZS02,
		SUM(DECODE(T5.VAL3,3,T5.VAL4,0)) AS BB03,
		SUM(DECODE(T5.VAL3,3,T5.VAL5,0)) AS ZS03,
		SUM(DECODE(T5.VAL3,4,T5.VAL4,0)) AS BB04,
		SUM(DECODE(T5.VAL3,4,T5.VAL5,0)) AS ZS04,
		SUM(DECODE(T5.VAL3,5,T5.VAL4,0)) AS BB05,
		SUM(DECODE(T5.VAL3,5,T5.VAL5,0)) AS ZS05,
		SUM(DECODE(T5.VAL3,6,T5.VAL4,0)) AS BB06,
		SUM(DECODE(T5.VAL3,6,T5.VAL5,0)) AS ZS06,
		SUM(DECODE(T5.VAL3,7,T5.VAL4,0)) AS BB07,
		SUM(DECODE(T5.VAL3,7,T5.VAL5,0)) AS ZS07,
		SUM(DECODE(T5.VAL3,8,T5.VAL4,0)) AS BB08,
		SUM(DECODE(T5.VAL3,8,T5.VAL5,0)) AS ZS08,
		SUM(DECODE(T5.VAL3,9,T5.VAL4,0)) AS BB09,
		SUM(DECODE(T5.VAL3,9,T5.VAL5,0)) AS ZS09,
		SUM(DECODE(T5.VAL3,10,T5.VAL4,0)) AS BB10,
		SUM(DECODE(T5.VAL3,10,T5.VAL5,0)) AS ZS10,
		SUM(DECODE(T5.VAL3,11,T5.VAL4,0)) AS BB11,
		SUM(DECODE(T5.VAL3,11,T5.VAL5,0)) AS ZS11,
		SUM(DECODE(T5.VAL3,12,T5.VAL4,0)) AS BB12,
		SUM(DECODE(T5.VAL3,12,T5.VAL5,0)) AS ZS12
		FROM T5
		GROUP BY
		T5.VAL0,T5.VAL1,T5.VAL2
		),

		T7 AS (
		SELECT
		T1.VAL00 AS VAL1,
		T1.VAL11 AS
		VAL2,
		T1.VAL22 AS VAL3,
		T3.VAL3 AS VAL4,
		T2.VAL3 AS VAL5,
		T4.VAL3 AS VAL6,
		T3.VAL4 AS VAL7,
		TRUNC(T6.BB01/10000,2) AS VAL8,
		TRUNC(T6.BB02/10000,2)
		AS VAL9,
		TRUNC(T6.BB03/10000,2) AS VAL10,
		TRUNC(T6.BB04/10000,2) AS
		VAL11,
		TRUNC(T6.BB05/10000,2) AS VAL12,
		TRUNC(T6.BB06/10000,2) AS VAL13,
		TRUNC(T6.BB07/10000,2) AS VAL14,
		TRUNC(T6.BB08/10000,2) AS VAL15,
		TRUNC(T6.BB09/10000,2) AS VAL16,
		TRUNC(T6.BB10/10000,2) AS VAL17,
		TRUNC(T6.BB11/10000,2) AS VAL18,
		TRUNC(T6.BB12/10000,2) AS VAL19,
		DECODE(T3.VAL5M,'',TO_NUMBER(''),NVL(T3.VAL5Z,0)/T3.VAL5M) RN,
		T3.VAL5Z AS VAL20Z,
		T3.VAL5M AS VAL20M,
		TRUNC(T3.VAL6/10000,2) AS VAL21,
		TRUNC(T6.ZS01/100,2) AS VAL22,
		TRUNC(T6.ZS02/100,2) AS VAL23,
		TRUNC(T6.ZS03/100,2) AS VAL24,
		TRUNC(T6.ZS04/100,2) AS VAL25,
		TRUNC(T6.ZS05/100,2) AS VAL26,
		TRUNC(T6.ZS06/100,2) AS VAL27,
		TRUNC(T6.ZS07/100,2) AS VAL28,
		TRUNC(T6.ZS08/100,2) AS VAL29,
		TRUNC(T6.ZS09/100,2) AS VAL30,
		TRUNC(T6.ZS10/100,2) AS VAL31,
		TRUNC(T6.ZS11/100,2) AS VAL32,
		TRUNC(T6.ZS12/100,2) AS VAL33,
		T3.VAL7Z
		AS VAL34Z,
		T3.VAL7M AS VAL34M,
		TRUNC(T3.VAL8/100,2) AS VAL35,
		T3.VAL9Z AS
		VAL36Z,
		T3.VAL9M AS VAL36M
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0 AND
		T1.VAL1=T2.VAL1
		AND T1.VAL2=T2.VAL2
		LEFT JOIN T3 ON T1.VAL0=T3.VAL0 AND
		T1.VAL1=T3.VAL1
		AND T1.VAL2=T3.VAL2
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0 AND
		T1.VAL1=T4.VAL1
		AND T1.VAL2=T4.VAL2
		LEFT JOIN T6 ON T1.VAL0=T6.VAL0 AND
		T1.VAL1=T6.VAL1
		AND T1.VAL2=T6.VAL2
		<if test="orderby7!=null">
			ORDER BY 7
		</if>
		<if test="orderby20!=null">
			ORDER BY 20 DESC NULLS LAST
		</if>
		)
		SELECT
		ROWNUM AS VAL0,
		T7.VAL1 AS VAL1,
		T7.VAL2 AS VAL2,
		T7.VAL3 AS VAL3,
		NVL(T7.VAL4,'--') AS VAL4,
		NVL(T7.VAL5,'--') AS VAL5,
		NVL(T7.VAL6,'--')
		AS VAL6,
		NVL(T7.VAL7,'--') AS VAL7,
		DECODE(T7.VAL8,'','--',TRIM(TO_CHAR(T7.VAL8,'99999999990.99')) ||
		'万元') AS VAL8,
		DECODE(T7.VAL9,'','--',TRIM(TO_CHAR(T7.VAL9,'99999999990.99')) ||
		'万元') AS VAL9,
		DECODE(T7.VAL10,'','--',TRIM(TO_CHAR(T7.VAL10,'99999999990.99')) ||
		'万元') AS VAL10,
		DECODE(T7.VAL11,'','--',TRIM(TO_CHAR(T7.VAL11,'99999999990.99')) ||
		'万元') AS VAL11,
		DECODE(T7.VAL12,'','--',TRIM(TO_CHAR(T7.VAL12,'99999999990.99')) ||
		'万元') AS VAL12,
		DECODE(T7.VAL13,'','--',TRIM(TO_CHAR(T7.VAL13,'99999999990.99')) ||
		'万元') AS VAL13,
		DECODE(T7.VAL14,'','--',TRIM(TO_CHAR(T7.VAL14,'99999999990.99')) ||
		'万元') AS VAL14,
		DECODE(T7.VAL15,'','--',TRIM(TO_CHAR(T7.VAL15,'99999999990.99')) ||
		'万元') AS VAL15,
		DECODE(T7.VAL16,'','--',TRIM(TO_CHAR(T7.VAL16,'99999999990.99')) ||
		'万元') AS VAL16,
		DECODE(T7.VAL17,'','--',TRIM(TO_CHAR(T7.VAL17,'99999999990.99')) ||
		'万元') AS VAL17,
		DECODE(T7.VAL18,'','--',TRIM(TO_CHAR(T7.VAL18,'99999999990.99')) ||
		'万元') AS VAL18,
		DECODE(T7.VAL19,'','--',TRIM(TO_CHAR(T7.VAL19,'99999999990.99')) ||
		'万元') AS VAL19,
		DECODE(NVL(T7.VAL20M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL20Z,0)/T7.VAL20M
		/10000,2),'99999999990.99'))||'万元') AS VAL20,
		DECODE(T7.VAL21,'','--',TRIM(TO_CHAR(T7.VAL21,'99999999990.99')) ||
		'万元') AS VAL21,
		DECODE(T7.VAL22,'','--',TRIM(TO_CHAR(T7.VAL22,'99999999990.99')) ||
		'百人') AS VAL22,
		DECODE(T7.VAL23,'','--',TRIM(TO_CHAR(T7.VAL23,'99999999990.99')) ||
		'百人') AS VAL23,
		DECODE(T7.VAL24,'','--',TRIM(TO_CHAR(T7.VAL24,'99999999990.99')) ||
		'百人') AS VAL24,
		DECODE(T7.VAL25,'','--',TRIM(TO_CHAR(T7.VAL25,'99999999990.99')) ||
		'百人') AS VAL25,
		DECODE(T7.VAL26,'','--',TRIM(TO_CHAR(T7.VAL26,'99999999990.99')) ||
		'百人') AS VAL26,
		DECODE(T7.VAL27,'','--',TRIM(TO_CHAR(T7.VAL27,'99999999990.99')) ||
		'百人') AS VAL27,
		DECODE(T7.VAL28,'','--',TRIM(TO_CHAR(T7.VAL28,'99999999990.99')) ||
		'百人') AS VAL28,
		DECODE(T7.VAL29,'','--',TRIM(TO_CHAR(T7.VAL29,'99999999990.99')) ||
		'百人') AS VAL29,
		DECODE(T7.VAL30,'','--',TRIM(TO_CHAR(T7.VAL30,'99999999990.99')) ||
		'百人') AS VAL30,
		DECODE(T7.VAL31,'','--',TRIM(TO_CHAR(T7.VAL31,'99999999990.99')) ||
		'百人') AS VAL31,
		DECODE(T7.VAL32,'','--',TRIM(TO_CHAR(T7.VAL32,'99999999990.99')) ||
		'百人') AS VAL32,
		DECODE(T7.VAL33,'','--',TRIM(TO_CHAR(T7.VAL33,'99999999990.99')) ||
		'百人') AS VAL33,
		DECODE(NVL(T7.VAL34M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL34Z,0)/T7.VAL34M/100,2),'99999999990.99'))||'百人')
		AS VAL34,
		DECODE(T7.VAL35,'','--',TRIM(TO_CHAR(T7.VAL35,'99999999990.99')) ||
		'百人') AS VAL35,
		DECODE(NVL(T7.VAL36M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T7.VAL36Z,0)/T7.VAL36M*100,2),'99999999990.99'))||'%')
		AS VAL36
		FROM T7

	</select>
	<select id="R1301010003" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		D.PROVCOMCODE AS VAL0,D.TEAMCOMSHORTNAME AS
		VAL00,
		D.COUNTCOMCODE AS VAL1,D.ACTUTEAMCOMSHORTNAME AS VAL11
		FROM
		D_MANAGECOM D
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		AND D.PROVCOMCODE IS NOT
		NULL AND
		D.PROVCOMCODE &lt;&gt; '1'
		AND ( D.COUNTCOMCODE &lt;&gt; D.PROVCOMCODE OR
		D.COUNTCOMCODE= '101' )
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		MIN(A.FIRST_INSURE_TIME) AS VAL2
		FROM HT_THREE_ORG_GRADE_DAY_TB A
		LEFT
		JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		LEFT JOIN
		HT_ORG_TAG_TB B
		ON B.ORG_CODE = A.MANAGECOM_CODE
		AND B.TAG_CODE = '1'
		AND B.STATUS = '1'
		AND A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND
		A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
    	GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T3 AS (
		SELECT
        D.PROVCOMCODE AS VAL0,
        D.COUNTCOMCODE AS VAL1,
        TRIM(TO_CHAR(TRUNC(SUM(A.FOUR_ORG_NUM),2),'9999999999999999999999990.99')) AS VAL2,
        TRIM(TO_CHAR(TRUNC(SUM(A.E_FOUR_ORG_NUM),2),'9999999999999999999999990.99')) AS VAL30,
        SUM(A.E_FOUR_ORG_NUM) AS VAL3Z,
        SUM(A.FOUR_ORG_NUM) AS VAL3M,
        SUM(A.SUM_PREM) AS VAL4,
        SUM(A.SUM_PREM) AS VAL5Z,
        SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL5M,
        SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL6Z,
        SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL6M,
        SUM(A.FACT_K2) AS VAL7Z,
        SUM(A.SHOU_K2) AS VAL7M,
        MAX(A.GRADE) AS VAL8,
        DECODE(MIN(A.IS_RISK_RANK),'是','1','否','0')  AS VAL31
        FROM HT_THREE_ORG_GRADE_DAY_TB A
	    LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE 
	    JOIN HT_ORG_TAG_TB B
	    ON B.ORG_CODE = A.MANAGECOM_CODE
	    AND B.TAG_CODE = '1'
	    AND B.STATUS = '1'
		AND A.DATE_CODE &gt;=
		B.VALID_BEGIN_DATE
		AND A.DATE_CODE
		&lt;= B.VALID_END_DATE
		WHERE 1=1
		AND
		D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND A.DATE_CODE = #{end_time}
		GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T4 AS (
		SELECT  D.PROVCOMCODE AS VAL0,
		        D.COUNTCOMCODE AS VAL1,
		        MAX(A.GRADE) AS VAL2,
		        SUM(A.E_FOUR_ORG_NUM) AS VAL3Z,
		        SUM(A.FOUR_ORG_NUM) AS VAL3M,
		        SUM(A.SUM_PREM) AS VAL4Z,
		        SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL4M,
		        SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL5Z,
		       SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL5M,
		        SUM(A.FACT_K2) AS VAL6Z,
		        SUM(A.SHOU_K2) AS VAL6M
		FROM HT_THREE_ORG_GRADE_DAY_TB A
		    LEFT JOIN D_MANAGECOM D ON A.MANAGECOM_CODE = D.MANAGECOMCODE 
		   JOIN HT_ORG_TAG_TB B
		   ON B.ORG_CODE = A.MANAGECOM_CODE
		   AND B.TAG_CODE = '1'
		   AND B.STATUS = '1'
		AND A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE 1=1
		AND
		D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
	   AND A.DATE_CODE = TO_CHAR(TO_NUMBER(SUBSTR(#{end_time},1,4))-1) || '-12-31'
	   GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T5 AS (
		SELECT
	       D.PROVCOMCODE AS VAL0,
	       D.COUNTCOMCODE AS VAL1,
	       MAX(A.GRADE) AS VAL2,
	       SUM(A.MON_AVE) AS VAL3,
	       SUM(A.MON_AVE_CONVERSION_MANPOWER) AS VAL4,
	       SUM(A.ORG_REACH_RATE) AS VAL5,
	       SUM(A.K2) AS VAL6
	      FROM HT_LABEL_ORG_TB A
	      LEFT JOIN D_MANAGECOM D ON A.ORG_CODE = D.COUNTCOMCODE 
		WHERE 1=1
		AND
		D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
	      AND A.DATE_CODE = SUBSTR(#{end_time},1,4)
	      GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE
		),
		T6 AS (
		SELECT M.VAL0 AS VAL0,   M.VAL1 AS VAL1,
		M.VALZ AS VALZ_DQ,
		M.VALM AS VALM_DQ,
		N.VALZ AS VALZ_TQ,
		N.VALM AS VALM_TQ
		FROM 
		(SELECT D.PROVCOMCODE AS VAL0,D.COUNTCOMCODE AS VAL1,
		       SUM(A.SUM_PREM) AS VALZ,
		      SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VALM  
		  FROM HT_THREE_ORG_GRADE_DAY_TB A
		  JOIN D_MANAGECOM D
		    ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		  JOIN HT_ORG_TAG_TB B
		    ON B.ORG_CODE = A.MANAGECOM_CODE
		AND B.TAG_CODE = '1'
		AND B.STATUS = '1'
		AND A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE 1 = 1
		AND
		HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		AND  A.DATE_CODE = #{end_time}
		  GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE)  M
		  JOIN
		 (SELECT D.PROVCOMCODE AS VAL0 ,D.COUNTCOMCODE AS VAL1,  
		         SUM(A.SUM_PREM) AS VALZ,
		         SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		            TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		             SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VALM
		  FROM HT_THREE_ORG_GRADE_DAY_TB A
		  JOIN D_MANAGECOM D
		    ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		  JOIN HT_ORG_TAG_TB B
		    ON B.ORG_CODE = A.MANAGECOM_CODE
		   AND B.TAG_CODE = '1'
		   AND B.STATUS = '1'
		AND A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE 1 = 1
		AND
		HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		  AND  A.DATE_CODE = TRIM(TO_CHAR(TO_NUMBER(SUBSTR(#{end_time} ,1,4)-1))) || '-12-31'
		  GROUP BY D.PROVCOMCODE  ,D.COUNTCOMCODE) N
		  ON M.VAL0 = N.VAL0 AND M.VAL1 = N.VAL1 
		),
		T7 AS (
		SELECT D.PROVCOMCODE AS VAL0,
		        D.COUNTCOMCODE AS VAL1,
		        SUM(A.SUM_PREM) AS VAL2
		 FROM HT_THREE_ORG_GRADE_DAY_TB A
		  JOIN D_MANAGECOM D
		    ON A.MANAGECOM_CODE = D.MANAGECOMCODE
		  JOIN HT_ORG_TAG_TB B
		    ON B.ORG_CODE = A.MANAGECOM_CODE
		   AND B.TAG_CODE = '1'
		   AND B.STATUS = '1'
		AND A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE 1 = 1
		AND
		HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
  			AND A.DATE_CODE = TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12)),'YYYY-MM-DD')
		  GROUP BY D.PROVCOMCODE ,D.COUNTCOMCODE
		),
		T8 AS (
		SELECT 
		    T1.VAL00 AS VAL1,
		    T1.VAL11 AS VAL2,
		    T2.VAL2  AS VAL3,
		    T4.VAL2  AS VAL4,
		    T4.VAL3Z AS VAL5Z,
		    T4.VAL3M AS VAL5M,
		    TRUNC(T7.VAL2/10000,2)  AS VAL6,
		    T4.VAL4Z AS VAL7Z,
		    T4.VAL4M AS VAL7M,
		    T4.VAL5Z AS VAL8Z,
		    T4.VAL5M AS VAL8M,
		    T4.VAL6Z AS VAL9Z,
		    T4.VAL6M AS VAL9M,
		    T5.VAL2  AS VAL10,
		    TRUNC(T5.VAL3/10000,2)  AS VAL11,
		    TRUNC(T5.VAL4/100,2)  AS VAL12,
		    TRUNC(T5.VAL5*100,2)  AS VAL13,
		    TRUNC(T5.VAL6*100,2)  AS VAL14,
		    T3.VAL2  AS VAL15,
		    T3.VAL30  AS VAL16,
		    T3.VAL3Z AS VAL17Z,
		    T3.VAL3M AS VAL17M,
		    TRUNC(T3.VAL4 /10000,2) AS VAL18,
		    TRUNC(T3.VAL5Z/T3.VAL5M/10000,2) AS RN1,
		    T3.VAL5Z AS VAL19Z,
		    T3.VAL5M AS VAL19M,
		    T6.VALZ_DQ AS VAL20Z_DQ,
		    T6.VALM_DQ AS VAL20M_DQ,
		    T6.VALZ_TQ AS VAL20Z_TQ,
		    T6.VALM_TQ AS VAL20M_TQ,
		    T3.VAL6Z AS VAL21Z,
		    T3.VAL6M AS VAL21M,
		    T3.VAL7Z AS VAL22Z,
		    T3.VAL7M AS VAL22M,
		    T3.VAL8  AS VAL23,
		    T3.VAL31  AS VAL24
		FROM T1
		LEFT JOIN T2 ON T1.VAL0=T2.VAL0 AND T1.VAL1=T2.VAL1
		LEFT JOIN T3 ON T1.VAL0=T3.VAL0 AND T1.VAL1=T3.VAL1
		LEFT JOIN T4 ON T1.VAL0=T4.VAL0 AND T1.VAL1=T4.VAL1
		LEFT JOIN T5 ON T1.VAL0=T5.VAL0 AND T1.VAL1=T5.VAL1
		LEFT JOIN T6 ON T1.VAL0=T6.VAL0 AND T1.VAL1=T6.VAL1
		LEFT JOIN T7 ON T1.VAL0=T7.VAL0 AND T1.VAL1=T7.VAL1
		<if test="orderby19!=null">
			ORDER BY 19 DESC NULLS LAST
		</if>
		<if test="orderby23!=null">
			ORDER BY 24
		</if>
		<if test="orderby24!=null">
			ORDER BY 25 DESC NULLS LAST
		</if>
		)

		SELECT 
		    ROWNUM AS VAL0,
		    T8.VAL1 AS VAL1,
		    T8.VAL2 AS VAL2,
		    NVL(T8.VAL3,'--')  AS VAL3,
		    NVL(T8.VAL4,'--')  AS VAL4,
		    DECODE(NVL(T8.VAL5M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL5Z,0)/T8.VAL5M*100,2),'9999999999999999999999990.99')) ||'%') AS VAL5,
		    DECODE(T8.VAL6,'','--',TRIM(TO_CHAR(T8.VAL6,'9999999999999999999999990.99')) || '万元')  AS VAL6, 
		    DECODE(NVL(T8.VAL7M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL7Z,0)/T8.VAL7M/10000,2),'9999999999999999999999990.99')) ||'万元') AS VAL7,
		    DECODE(NVL(T8.VAL8M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL8Z,0)/T8.VAL8M/100,2),'9999999999999999999999990.99')) ||'百人') AS VAL8,
		    DECODE(NVL(T8.VAL9M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL9Z,0)/T8.VAL9M*100,2),'9999999999999999999999990.99')) ||'%') AS VAL9,
		    NVL(T8.VAL10,'--')  AS VAL10,
		    DECODE(T8.VAL11,'','--',TRIM(TO_CHAR(T8.VAL11,'9999999999999999999999990.99')) || '万元') AS VAL11,
		    DECODE(T8.VAL12,'','--',TRIM(TO_CHAR(T8.VAL12,'9999999999999999999999990.99')) || '百人' ) AS VAL12,
		    DECODE(T8.VAL13,'','--',TRIM(TO_CHAR(T8.VAL13,'9999999999999999999999990.99')) || '%') AS VAL13,
		    DECODE(T8.VAL14,'','--',TRIM(TO_CHAR(T8.VAL14,'9999999999999999999999990.99')) || '%') AS VAL14,
		    NVL(T8.VAL15,'--')  AS VAL15,
		    NVL(T8.VAL16,'--')  AS VAL16,
		    DECODE(NVL(T8.VAL17M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL17Z,0)/T8.VAL17M*100,2),'9999999999999999999999990.99')) ||'%') AS VAL17,
		    DECODE(NVL(T8.VAL18,0),0,'--',TRIM(TO_CHAR(T8.VAL18,'9999999999999999999999990.99')) || '万元' ) AS VAL18,
		    DECODE(NVL(T8.VAL19M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL19Z,0)/T8.VAL19M/10000,2),'9999999999999999999999990.99')) ||'万元') AS VAL19,
		    DECODE(DECODE(NVL(T8.VAL20M_TQ,0),0,0,NVL(T8.VAL20Z_TQ,0)/T8.VAL20M_TQ/10000),0,'--',
		    TRUNC((DECODE(NVL(T8.VAL20M_DQ,0),0,TO_NUMBER(''),NVL(T8.VAL20Z_DQ,0)/T8.VAL20M_DQ/10000)/
		    DECODE(NVL(T8.VAL20M_TQ,0),0,0,NVL(T8.VAL20Z_TQ,0)/T8.VAL20M_TQ/10000) -1)*100,2) ||'%') AS VAL20,
		    DECODE(NVL(T8.VAL21M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL21Z,0)/T8.VAL21M/100,2),'9999999999999999999999990.99')) ||'百人') AS VAL21,  
		    DECODE(NVL(T8.VAL22M,0),0,'--',TRIM(TO_CHAR(TRUNC(NVL(T8.VAL22Z,0)/T8.VAL22M*100,2),'9999999999999999999999990.99')) ||'%') AS VAL22,
		    NVL(T8.VAL23,'--')  AS VAL23,
		    NVL(T8.VAL24,'--')  AS VAL24 
		FROM T8
	</select>
	<select id="R1301010004" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		WITH
		T1 AS(
		SELECT DISTINCT
		D.PROVCOMCODE AS VAL0,D.TEAMCOMSHORTNAME AS
		VAL00,
		D.COUNTCOMCODE AS VAL1,D.ACTUTEAMCOMSHORTNAME AS VAL11,
		D.COST_CENTERSTDCODE AS VAL2,D.COST_CENTERDEVNAME AS VAL22
		FROM
		D_ORGANIZATION D
		WHERE 1=1
		AND D.PROVCOMCODE IS NOT NULL AND
		D.PROVCOMCODE &lt;&gt; '1'
		AND (
		D.COUNTCOMCODE &lt;&gt; D.PROVCOMCODE OR
		D.COUNTCOMCODE= '101' )
		AND
		D.COST_CENTERSTDCODE IS NOT NULL
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		ORDER BY 1
		),
		T2 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MIN(A.FIRST_INSURE_TIME) AS VAL3
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE!='1'
		) D
		ON
		A.GROUP_CODE = D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B
		ON B.ORG_CODE =
		A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND A.DATE_CODE
		&gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;= B.VALID_END_DATE
		WHERE
		1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE &gt;= #{start_time}
		AND A.DATE_CODE &lt;= #{end_time}
		GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T3 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MAX(A.AGENCY_SIGN) AS VAL3,
		SUM(A.SUM_PREM) AS VAL4,
		SUM(A.SUM_PREM) AS VAL5Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL5M,
		SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL6Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL6M,
		SUM(A.FACT_K2) AS VAL7Z,
		SUM(A.SHOU_K2) AS VAL7M,
		MAX(A.GRADE) AS VAL8,
		MAX(DECODE(A.IS_RISK_RANK,'是','1','否','0',A.IS_RISK_RANK)) AS VAL31
		FROM HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN
		(SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1' )
		D ON A.GROUP_CODE
		= D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B ON
		B.ORG_CODE =
		A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND
		A.DATE_CODE
		&gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;=
		B.VALID_END_DATE
		WHERE
		1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T4 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS
		VAL2,
		MAX(A.GRADE) AS VAL3,
		SUM(A.SUM_PREM) AS VAL4Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL4M,
		SUM(A.MONTH_MANPOVER_CONV_TOTAL) AS VAL5Z,
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))) AS VAL5M,
		SUM(A.FACT_K2) AS VAL6Z,
		SUM(A.SHOU_K2) AS VAL6M
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1'
		)
		D ON A.GROUP_CODE = D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B
		ON
		B.ORG_CODE = A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND
		A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE
		&lt;=
		B.VALID_END_DATE
		WHERE 1=1
		AND D.HEADCOMCODE = '1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = TO_CHAR(TO_NUMBER(SUBSTR(#{end_time},1,4))-1) ||
		'-12-31'
		GROUP BY D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T5 AS (
		SELECT
		D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		MAX(A.GRADE) AS VAL3,
		SUM(A.MON_AVE) AS
		VAL4,
		SUM(A.MON_AVE_CONVERSION_MANPOWER) AS VAL5,
		SUM(A.K2) AS VAL6
		FROM
		HT_LABEL_ORG_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1'
		)
		D ON A.ORG_CODE = D.COST_CENTERSTDCODE
		WHERE 1=1
		AND D.HEADCOMCODE =
		'1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = SUBSTR(#{end_time},1,4)
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T6 AS (
		<!-- 月均标保增长率 -->
		SELECT M.VAL0 AS VAL0, M.VAL1 AS VAL1, M.VAL2 AS VAL2,
		M.VAL AS
		VAL3_DQ,
		N.VAL AS VAL3_TQ
		FROM
		(SELECT D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		DECODE(SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))),
		0,TO_NUMBER(''),
		NVL(SUM(A.SUM_PREM),0) /
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')))))) AS VAL
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1'
		)
		D
		ON A.GROUP_CODE = D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B
		ON
		B.ORG_CODE = A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND
		A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;=
		B.VALID_END_DATE
		WHERE 1 = 1
		AND HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = #{end_time}
		GROUP BY
		D.PROVCOMCODE,D.COUNTCOMCODE,D.COST_CENTERSTDCODE) M
		JOIN
		(SELECT
		D.PROVCOMCODE AS VAL0 ,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS
		VAL2,
		DECODE(SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD'))))),
		0,TO_NUMBER(''),
		NVL(SUM(A.SUM_PREM),0) /
		SUM(CEIL(DECODE(MONTHS_BETWEEN(TO_DATE(A.DATE_CODE, 'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4)
		||'-01-01'),'YYYY-MM-DD')),0,1,MONTHS_BETWEEN(TO_DATE(A.DATE_CODE,
		'YYYY-MM-DD'),
		TO_DATE(GREATEST(A.FIRST_INSURE_TIME,
		SUBSTR(A.DATE_CODE,1,4) ||'-01-01'),'YYYY-MM-DD')))))) AS VAL
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1'
		)
		D
		ON A.GROUP_CODE = D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B ON
		B.ORG_CODE = A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND
		A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE &lt;=
		B.VALID_END_DATE
		WHERE 1 = 1
		AND HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE = TRIM(TO_CHAR(TO_NUMBER(SUBSTR(#{end_time},1,4)-1)))
		|| '-12-31'
		GROUP BY D.PROVCOMCODE
		,D.COUNTCOMCODE,D.COST_CENTERSTDCODE) N
		ON M.VAL0 = N.VAL0 AND M.VAL1 =
		N.VAL1 AND M.VAL2 = N.VAL2
		),
		T7 AS (
		<!--上一年度序时标保 -->
		SELECT D.PROVCOMCODE AS VAL0,
		D.COUNTCOMCODE AS VAL1,
		D.COST_CENTERSTDCODE AS VAL2,
		SUM(A.SUM_PREM) AS VAL3
		FROM
		HT_FOUR_ORG_GRADE_DAY_TB A
		JOIN (SELECT DISTINCT MANAGECOMCODE,
		MANAGECOMNAME,
		HEADCOMCODE,
		HEADCOMNAME,
		PROVCOMCODE,
		PROVCOMNAME,
		COUNTCOMCODE,
		COUNTCOMNAME,
		TEAMCOMCODE,
		TEAMCOMNAME,
		TEAMCOMSHORTNAME,
		ACTUTEAMCOMSHORTNAME,
		COST_CENTER,
		COST_CENTERSTDCODE,
		COST_CENTERDEVNAME
		FROM D_ORGANIZATION WHERE PROVCOMCODE &lt;&gt; '1'
		)
		D
		ON A.GROUP_CODE = D.COST_CENTERSTDCODE
		JOIN HT_ORG_TAG_TB B
		ON
		B.ORG_CODE = A.GROUP_CODE
		AND B.TAG_CODE = '2'
		AND B.STATUS = '1'
		AND
		A.DATE_CODE &gt;= B.VALID_BEGIN_DATE
		AND A.DATE_CODE
		&lt;=
		B.VALID_END_DATE
		WHERE 1 = 1
		AND HEADCOMCODE='1'
		<if test="provcomcode!=null">
			AND D.PROVCOMCODE =#{provcomcode}
		</if>
		<if test="countcomcode!=null">
			AND D.COUNTCOMCODE =#{countcomcode}
		</if>
		<if test="costcenterstdcode!=null">
			AND D.COST_CENTERSTDCODE =#{costcenterstdcode}
		</if>
		AND A.DATE_CODE =
		TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(#{end_time},'YYYY-MM-DD'),-12)),'YYYY-MM-DD')
		GROUP BY D.PROVCOMCODE ,D.COUNTCOMCODE,D.COST_CENTERSTDCODE
		),
		T8 AS (
		SELECT
		T1.VAL00 AS VAL1,
		T1.VAL11 AS VAL2,
		T1.VAL22 AS VAL3,
		T3.VAL3 AS
		VAL4,
		T2.VAL3 AS VAL5,
		T4.VAL3 AS VAL6,
		TRUNC(T7.VAL3/10000,2) AS VAL7,
		T4.VAL4Z AS VAL8Z,
		T4.VAL4M AS VAL8M,
		T4.VAL5Z AS VAL9Z,
		T4.VAL5M AS
		VAL9M,
		T4.VAL6Z AS VAL10Z,
		T4.VAL6M AS VAL10M,
		T5.VAL3 AS VAL11,
		TRUNC(T5.VAL4/10000,2) AS VAL12,
		TRUNC(T5.VAL5/100,2) AS VAL13,
		TRUNC(T5.VAL6*100,2) AS VAL14,
		TRUNC(T3.VAL4/10000,2) AS VAL15,
		DECODE(T3.VAL5M,0,TO_NUMBER(''),NVL(T3.VAL5Z,0)/T3.VAL5M) RN,
		T3.VAL5Z
		AS VAL16Z,
		T3.VAL5M AS VAL16M,
		T6.VAL3_DQ AS VAL17_DQ,
		T6.VAL3_TQ AS
		VAL17_TQ,
		T3.VAL6Z AS VAL18Z,
		T3.VAL6M AS VAL18M,
		T3.VAL7Z AS VAL19Z,
		T3.VAL7M AS VAL19M,
		T3.VAL8 AS VAL20,
		T3.VAL31 AS VAL21
		FROM T1
		LEFT JOIN
		T2 ON T1.VAL0=T2.VAL0 AND T1.VAL1=T2.VAL1
		AND T1.VAL2=T2.VAL2
		LEFT JOIN
		T3 ON T1.VAL0=T3.VAL0 AND T1.VAL1=T3.VAL1
		AND T1.VAL2=T3.VAL2
		LEFT JOIN
		T4 ON T1.VAL0=T4.VAL0 AND T1.VAL1=T4.VAL1
		AND T1.VAL2=T4.VAL2
		LEFT JOIN
		T5 ON T1.VAL0=T5.VAL0 AND T1.VAL1=T5.VAL1
		AND T1.VAL2=T5.VAL2
		LEFT JOIN
		T6 ON T1.VAL0=T6.VAL0 AND T1.VAL1=T6.VAL1
		AND T1.VAL2=T6.VAL2
		LEFT JOIN
		T7 ON T1.VAL0=T7.VAL0 AND T1.VAL1=T7.VAL1
		AND T1.VAL2=T7.VAL2
		<if test="orderby16!=null">
			ORDER BY 16 DESC NULLS LAST
		</if>
		<if test="orderby20!=null">
			ORDER BY 21
		</if>
		<if test="orderby21!=null">
			ORDER BY 22 DESC NULLS LAST
		</if>
		)
		SELECT
		ROWNUM AS VAL0,
		T8.VAL1 AS VAL1,
		T8.VAL2 AS VAL2,
		T8.VAL3 AS VAL3,
		NVL(T8.VAL4,'--') AS VAL4,
		NVL(T8.VAL5,'--') AS VAL5,
		NVL(T8.VAL6,'--')
		AS VAL6,
		DECODE(T8.VAL7,'','--',TRIM(TO_CHAR(T8.VAL7,'9999999990.99'))
		|| '万元')
		AS VAL7,
		DECODE(NVL(T8.VAL8M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL8Z,0)/T8.VAL8M/10000
		,2),'9999999990.99')) || '万元') AS VAL8,
		DECODE(NVL(T8.VAL9M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL9Z,0)/T8.VAL9M/100 ,2),'9999999990.99'))
		|| '百人') AS VAL9,
		DECODE(NVL(T8.VAL10M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL10Z,0)/T8.VAL10M*100
		,2),'9999999990.99')) || '%') AS VAL10,
		NVL(T8.VAL11,'--') AS VAL11,
		DECODE(T8.VAL12,'','--',
		TRIM(TO_CHAR(T8.VAL12,'9999999990.99')) ||
		'万元') AS VAL12,
		DECODE(T8.VAL13,'','--',
		TRIM(TO_CHAR(T8.VAL13,'9999999990.99')) || '百人') AS VAL13,
		DECODE(T8.VAL14,'','--',
		TRIM(TO_CHAR(T8.VAL14,'9999999990.99')) ||
		'%') AS VAL14,
		DECODE(T8.VAL15,'','--',
		TRIM(TO_CHAR(T8.VAL15,'9999999990.99')) || '万元') AS VAL15,
		DECODE(NVL(T8.VAL16M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL16Z,0)/T8.VAL16M/10000
		,2),'9999999990.99')) || '万元') AS VAL16,
		DECODE(NVL(T8.VAL17_TQ,0),0,'--',
		TRIM(TO_CHAR(TRUNC((NVL(T8.VAL17_DQ,0)/T8.VAL17_TQ-1) *100
		,2),'9999999990.99')) || '%') AS VAL17,
		DECODE(NVL(T8.VAL18M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL18Z,0)/T8.VAL18M/100
		,2),'9999999990.99')) || '百人') AS VAL18,
		DECODE(NVL(T8.VAL19M,0),0,'--',
		TRIM(TO_CHAR(TRUNC(NVL(T8.VAL19Z,0)/T8.VAL19M*100
		,2),'9999999990.99')) || '%') AS VAL19,
		NVL(T8.VAL20,'--') AS VAL20,
		NVL(T8.VAL21,'--') AS VAL21
		FROM T8
	</select>

	<select id="R1301050001" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT * FROM (
		SELECT tt.*, ROWNUM AS rowno FROM(
		SELECT "R1301050001"
		AS VAL0 FROM DUAL
		WHERE 1=1
		<if test="level!=null">
			AND 1=1
		</if>
		<if test="channel!=null">
			AND 1=1
		</if>
		<if test="riskName!=null">
			AND 1=1
		</if>
		<if test="kn!=null">
			AND 1=1
		</if>

		) tt
		WHERE ROWNUM &lt;= #{endRow} ) ttt
		WHERE ttt.rowno &gt; #{startRow}
	</select>

</mapper>